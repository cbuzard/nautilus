<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>&lt;a href= http://code.google.com/p/nautilus/&gt;Nautilus&lt;/a&gt;: dust_temperature.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname"><a href= http://code.google.com/p/nautilus/>Nautilus</a></div>
   <div id="projectbrief">1D gas-grain chemical model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">dust_temperature.f90</div>  </div>
</div>
<div class="contents">
<a href="dust__temperature_8f90.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">!******************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">! MODULE: dust_temperature</span>
<a name="l00003"></a>00003 <span class="comment">!******************************************************************************</span>
<a name="l00004"></a>00004 <span class="comment">!</span>
<a name="l00005"></a>00005 <span class="comment">! DESCRIPTION: </span>
<a name="l00013"></a>00013 
<a name="l00014"></a><a class="code" href="namespacedust__temperature.html">00014</a> <span class="keyword">module</span> dust_temperature
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 use <span class="keywordflow">iso_fortran_env</span>, only : error_unit
<a name="l00017"></a>00017 use <span class="keywordflow">global_variables</span>
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="keyword">implicit none</span>
<a name="l00020"></a>00020 
<a name="l00021"></a><a class="code" href="namespacedust__temperature.html#abc7667a19268b4a29cb6999c40295e0d">00021</a> <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: nb_wavelengths=500
<a name="l00022"></a><a class="code" href="namespacedust__temperature.html#a74304c49ba26195db71939ab6eb16b38">00022</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">dimension(nb_wavelengths)</span> :: wavelength = [ <span class="comment">!&lt; Wavelength [Angstrom]</span>
<a name="l00023"></a>00023 9.118d+02, 9.433d+02, 9.759d+02, 1.010d+03, 1.045d+03, 1.081d+03, 1.118d+03, 1.157d+03, 1.197d+03, 1.238d+03, 1.281d+03, 
<a name="l00024"></a>00024 1.325d+03, 1.371d+03, 1.418d+03, 1.468d+03, 1.518d+03, 1.571d+03, 1.625d+03, 1.681d+03, 1.739d+03, 1.800d+03, 1.862d+03, 
<a name="l00025"></a>00025 1.926d+03, 1.993d+03, 2.062d+03, 2.133d+03, 2.207d+03, 2.283d+03, 2.362d+03, 2.444d+03, 2.528d+03, 2.616d+03, 2.706d+03, 
<a name="l00026"></a>00026 2.800d+03, 2.897d+03, 2.997d+03, 3.100d+03, 3.208d+03, 3.319d+03, 3.433d+03, 3.552d+03, 3.675d+03, 3.802d+03, 3.933d+03, 
<a name="l00027"></a>00027 4.070d+03, 4.210d+03, 4.356d+03, 4.506d+03, 4.662d+03, 4.824d+03, 4.990d+03, 5.163d+03, 5.342d+03, 5.526d+03, 5.717d+03, 
<a name="l00028"></a>00028 5.915d+03, 6.120d+03, 6.331d+03, 6.550d+03, 6.777d+03, 7.011d+03, 7.254d+03, 7.504d+03, 7.764d+03, 8.032d+03, 8.310d+03, 
<a name="l00029"></a>00029 8.598d+03, 8.895d+03, 9.202d+03, 9.521d+03, 9.850d+03, 1.019d+04, 1.054d+04, 1.091d+04, 1.128d+04, 1.168d+04, 1.208d+04, 
<a name="l00030"></a>00030 1.250d+04, 1.293d+04, 1.338d+04, 1.384d+04, 1.432d+04, 1.481d+04, 1.532d+04, 1.585d+04, 1.640d+04, 1.697d+04, 1.756d+04, 
<a name="l00031"></a>00031 1.816d+04, 1.879d+04, 1.944d+04, 2.011d+04, 2.081d+04, 2.153d+04, 2.227d+04, 2.304d+04, 2.384d+04, 2.467d+04, 2.552d+04, 
<a name="l00032"></a>00032 2.640d+04, 2.731d+04, 2.826d+04, 2.924d+04, 3.025d+04, 3.129d+04, 3.238d+04, 3.349d+04, 3.465d+04, 3.585d+04, 3.709d+04, 
<a name="l00033"></a>00033 3.837d+04, 3.970d+04, 4.107d+04, 4.249d+04, 4.396d+04, 4.548d+04, 4.706d+04, 4.868d+04, 5.037d+04, 5.211d+04, 5.391d+04, 
<a name="l00034"></a>00034 5.578d+04, 5.771d+04, 5.970d+04, 6.177d+04, 6.390d+04, 6.611d+04, 6.840d+04, 7.076d+04, 7.321d+04, 7.574d+04, 7.836d+04, 
<a name="l00035"></a>00035 8.107d+04, 8.388d+04, 8.678d+04, 8.978d+04, 9.288d+04, 9.609d+04, 9.942d+04, 1.029d+05, 1.064d+05, 1.101d+05, 1.139d+05, 
<a name="l00036"></a>00036 1.178d+05, 1.219d+05, 1.261d+05, 1.305d+05, 1.350d+05, 1.397d+05, 1.445d+05, 1.495d+05, 1.547d+05, 1.600d+05, 1.656d+05, 
<a name="l00037"></a>00037 1.713d+05, 1.772d+05, 1.833d+05, 1.897d+05, 1.962d+05, 2.030d+05, 2.100d+05, 2.173d+05, 2.248d+05, 2.326d+05, 2.406d+05, 
<a name="l00038"></a>00038 2.490d+05, 2.576d+05, 2.665d+05, 2.757d+05, 2.852d+05, 2.951d+05, 3.053d+05, 3.158d+05, 3.268d+05, 3.381d+05, 3.498d+05, 
<a name="l00039"></a>00039 3.619d+05, 3.744d+05, 3.873d+05, 4.007d+05, 4.146d+05, 4.289d+05, 4.437d+05, 4.591d+05, 4.750d+05, 4.914d+05, 5.084d+05, 
<a name="l00040"></a>00040 5.260d+05, 5.441d+05, 5.630d+05, 5.824d+05, 6.026d+05, 6.234d+05, 6.450d+05, 6.673d+05, 6.904d+05, 7.142d+05, 7.389d+05, 
<a name="l00041"></a>00041 7.645d+05, 7.909d+05, 8.183d+05, 8.466d+05, 8.758d+05, 9.061d+05, 9.375d+05, 9.699d+05, 1.003d+06, 1.038d+06, 1.074d+06, 
<a name="l00042"></a>00042 1.111d+06, 1.150d+06, 1.189d+06, 1.230d+06, 1.273d+06, 1.317d+06, 1.363d+06, 1.410d+06, 1.458d+06, 1.509d+06, 1.561d+06, 
<a name="l00043"></a>00043 1.615d+06, 1.671d+06, 1.729d+06, 1.789d+06, 1.850d+06, 1.914d+06, 1.981d+06, 2.049d+06, 2.120d+06, 2.193d+06, 2.269d+06, 
<a name="l00044"></a>00044 2.348d+06, 2.429d+06, 2.513d+06, 2.600d+06, 2.690d+06, 2.783d+06, 2.879d+06, 2.978d+06, 3.081d+06, 3.188d+06, 3.298d+06, 
<a name="l00045"></a>00045 3.412d+06, 3.530d+06, 3.652d+06, 3.779d+06, 3.909d+06, 4.044d+06, 4.184d+06, 4.329d+06, 4.479d+06, 4.634d+06, 4.794d+06, 
<a name="l00046"></a>00046 4.960d+06, 5.131d+06, 5.309d+06, 5.492d+06, 5.682d+06, 5.879d+06, 6.082d+06, 6.292d+06, 6.510d+06, 6.735d+06, 6.968d+06, 
<a name="l00047"></a>00047 7.209d+06, 7.458d+06, 7.716d+06, 7.983d+06, 8.259d+06, 8.544d+06, 8.840d+06, 9.146d+06, 9.462d+06, 9.789d+06, 1.013d+07, 
<a name="l00048"></a>00048 1.048d+07, 1.084d+07, 1.122d+07, 1.160d+07, 1.200d+07, 1.242d+07, 1.285d+07, 1.329d+07, 1.375d+07, 1.423d+07, 1.472d+07, 
<a name="l00049"></a>00049 1.523d+07, 1.576d+07, 1.630d+07, 1.687d+07, 1.745d+07, 1.805d+07, 1.868d+07, 1.932d+07, 1.999d+07, 2.068d+07, 2.140d+07, 
<a name="l00050"></a>00050 2.214d+07, 2.290d+07, 2.369d+07, 2.451d+07, 2.536d+07, 2.624d+07, 2.715d+07, 2.808d+07, 2.906d+07, 3.006d+07, 3.110d+07, 
<a name="l00051"></a>00051 3.218d+07, 3.329d+07, 3.444d+07, 3.563d+07, 3.686d+07, 3.814d+07, 3.946d+07, 4.082d+07, 4.223d+07, 4.369d+07, 4.520d+07, 
<a name="l00052"></a>00052 4.677d+07, 4.838d+07, 5.006d+07, 5.179d+07, 5.358d+07, 5.543d+07, 5.735d+07, 5.933d+07, 6.138d+07, 6.351d+07, 6.570d+07, 
<a name="l00053"></a>00053 6.798d+07, 7.033d+07, 7.276d+07, 7.528d+07, 7.788d+07, 8.057d+07, 8.336d+07, 8.624d+07, 8.922d+07, 9.231d+07, 9.550d+07, 
<a name="l00054"></a>00054 9.880d+07, 1.022d+08, 1.058d+08, 1.094d+08, 1.132d+08, 1.171d+08, 1.212d+08, 1.254d+08, 1.297d+08, 1.342d+08, 1.388d+08, 
<a name="l00055"></a>00055 1.436d+08, 1.486d+08, 1.537d+08, 1.590d+08, 1.645d+08, 1.702d+08, 1.761d+08, 1.822d+08, 1.885d+08, 1.950d+08, 2.018d+08, 
<a name="l00056"></a>00056 2.087d+08, 2.160d+08, 2.234d+08, 2.312d+08, 2.391d+08, 2.474d+08, 2.560d+08, 2.648d+08, 2.740d+08, 2.835d+08, 2.933d+08, 
<a name="l00057"></a>00057 3.034d+08, 3.139d+08, 3.248d+08, 3.360d+08, 3.476d+08, 3.596d+08, 3.721d+08, 3.849d+08, 3.982d+08, 4.120d+08, 4.263d+08, 
<a name="l00058"></a>00058 4.410d+08, 4.562d+08, 4.720d+08, 4.883d+08, 5.052d+08, 5.227d+08, 5.408d+08, 5.595d+08, 5.788d+08, 5.989d+08, 6.196d+08, 
<a name="l00059"></a>00059 6.410d+08, 6.632d+08, 6.861d+08, 7.098d+08, 7.344d+08, 7.598d+08, 7.860d+08, 8.132d+08, 8.413d+08, 8.704d+08, 9.005d+08, 
<a name="l00060"></a>00060 9.317d+08, 9.639d+08, 9.972d+08, 1.032d+09, 1.067d+09, 1.104d+09, 1.143d+09, 1.182d+09, 1.223d+09, 1.265d+09, 1.309d+09, 
<a name="l00061"></a>00061 1.354d+09, 1.401d+09, 1.449d+09, 1.500d+09, 1.551d+09, 1.605d+09, 1.661d+09, 1.718d+09, 1.777d+09, 1.839d+09, 1.903d+09, 
<a name="l00062"></a>00062 1.968d+09, 2.036d+09, 2.107d+09, 2.180d+09, 2.255d+09, 2.333d+09, 2.414d+09, 2.497d+09, 2.584d+09, 2.673d+09, 2.765d+09, 
<a name="l00063"></a>00063 2.861d+09, 2.960d+09, 3.062d+09, 3.168d+09, 3.278d+09, 3.391d+09, 3.508d+09, 3.630d+09, 3.755d+09, 3.885d+09, 4.019d+09, 
<a name="l00064"></a>00064 4.158d+09, 4.302d+09, 4.451d+09, 4.605d+09, 4.764d+09, 4.929d+09, 5.099d+09, 5.276d+09, 5.458d+09, 5.647d+09, 5.842d+09, 
<a name="l00065"></a>00065 6.044d+09, 6.253d+09, 6.470d+09, 6.693d+09, 6.925d+09, 7.164d+09, 7.412d+09, 7.668d+09, 7.934d+09, 8.208d+09, 8.492d+09, 
<a name="l00066"></a>00066 8.785d+09, 9.089d+09, 9.404d+09, 9.729d+09, 1.007d+10, 1.041d+10, 1.077d+10, 1.115d+10, 1.153d+10, 1.193d+10, 1.234d+10, 
<a name="l00067"></a>00067 1.277d+10, 1.321d+10, 1.367d+10, 1.414d+10, 1.463d+10, 1.514d+10, 1.566d+10, 1.620d+10, 1.676d+10, 1.734d+10, 1.794d+10, 
<a name="l00068"></a>00068 1.856d+10, 1.920d+10, 1.987d+10, 2.055d+10, 2.126d+10]
<a name="l00069"></a>00069 
<a name="l00070"></a><a class="code" href="namespacedust__temperature.html#ae51d0542c9255ad75448db1835866d24">00070</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">dimension(nb_wavelengths)</span> :: incident_dust_flux = [ <span class="comment">!&lt; incident dust flux [erg.cm-2.s-1.A-1.sr-1]</span>
<a name="l00071"></a>00071 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00072"></a>00072 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00073"></a>00073 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00074"></a>00074 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00075"></a>00075 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00076"></a>00076 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00077"></a>00077 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 5.888d-10, 1.222d-09, 6.861d-10, 4.963d-10, 5.079d-10, 6.569d-10, 
<a name="l00078"></a>00078 9.016d-10, 8.933d-10, 7.119d-10, 5.954d-10, 5.372d-10, 5.085d-10, 4.942d-10, 4.871d-10, 4.836d-10, 4.801d-10, 4.733d-10, 
<a name="l00079"></a>00079 4.543d-10, 4.145d-10, 4.165d-10, 4.551d-10, 4.763d-10, 4.863d-10, 4.920d-10, 4.950d-10, 4.973d-10, 4.996d-10, 5.014d-10, 
<a name="l00080"></a>00080 5.041d-10, 5.087d-10, 5.183d-10, 5.394d-10, 5.960d-10, 8.052d-10, 3.220d-09, 4.763d-09, 8.774d-10, 6.064d-10, 5.304d-10, 
<a name="l00081"></a>00081 4.990d-10, 4.842d-10, 4.776d-10, 4.766d-10, 4.812d-10, 4.927d-10, 5.141d-10, 5.552d-10, 6.561d-10, 1.143d-09, 1.052d-09, 
<a name="l00082"></a>00082 1.397d-09, 2.041d-09, 2.426d-09, 1.120d-08, 4.654d-09, 3.403d-09, 3.383d-09, 3.913d-09, 6.347d-09, 1.307d-08, 1.244d-08, 
<a name="l00083"></a>00083 6.131d-09, 4.507d-09, 4.921d-09, 2.088d-09, 1.457d-09, 1.246d-09, 1.168d-09, 1.193d-09, 1.422d-09, 2.722d-09, 6.300d-09, 
<a name="l00084"></a>00084 2.909d-09, 2.923d-09, 3.828d-09, 2.029d-09, 1.929d-09, 1.410d-09, 1.226d-09, 1.120d-09, 1.100d-09, 1.157d-09, 1.524d-09, 
<a name="l00085"></a>00085 1.441d-09, 1.125d-09, 9.238d-10, 8.874d-10, 7.588d-10, 6.986d-10, 6.503d-10, 6.084d-10, 5.721d-10, 5.410d-10, 5.146d-10, 
<a name="l00086"></a>00086 4.928d-10, 4.747d-10, 4.608d-10, 4.504d-10, 4.427d-10, 4.381d-10, 4.356d-10, 4.344d-10, 4.341d-10, 4.338d-10, 4.338d-10, 
<a name="l00087"></a>00087 4.335d-10, 4.331d-10, 4.331d-10, 4.334d-10, 4.353d-10, 4.393d-10, 4.456d-10, 4.548d-10, 4.675d-10, 4.838d-10, 5.040d-10, 
<a name="l00088"></a>00088 5.285d-10, 5.567d-10, 5.886d-10, 6.239d-10, 6.625d-10, 7.034d-10, 7.464d-10, 7.900d-10, 8.346d-10, 8.777d-10, 9.207d-10, 
<a name="l00089"></a>00089 9.611d-10, 9.986d-10, 1.032d-09, 1.061d-09, 1.086d-09, 1.105d-09, 1.119d-09, 1.127d-09, 1.130d-09, 1.126d-09, 1.118d-09, 
<a name="l00090"></a>00090 1.104d-09, 1.088d-09, 1.070d-09, 1.050d-09, 1.030d-09, 1.011d-09, 9.866d-10, 9.447d-10, 8.836d-10, 8.174d-10, 7.537d-10, 
<a name="l00091"></a>00091 6.946d-10, 6.396d-10, 5.874d-10, 5.376d-10, 4.913d-10, 4.467d-10, 4.052d-10, 3.661d-10, 3.299d-10, 2.962d-10, 2.649d-10, 
<a name="l00092"></a>00092 2.362d-10, 2.099d-10, 1.854d-10, 1.626d-10, 1.421d-10, 1.240d-10, 1.080d-10, 9.379d-11, 8.130d-11, 7.037d-11, 6.074d-11, 
<a name="l00093"></a>00093 5.237d-11, 4.507d-11, 3.872d-11, 3.324d-11, 2.847d-11, 2.437d-11, 2.084d-11, 1.779d-11, 1.517d-11, 1.294d-11, 1.102d-11, 
<a name="l00094"></a>00094 9.370d-12, 7.962d-12, 6.764d-12, 5.737d-12, 4.869d-12, 4.126d-12, 3.495d-12, 2.961d-12, 2.505d-12, 2.121d-12, 1.793d-12, 
<a name="l00095"></a>00095 1.516d-12, 1.280d-12, 1.082d-12, 9.128d-13, 7.698d-13, 6.491d-13, 5.468d-13, 4.600d-13, 3.868d-13, 3.252d-13, 2.734d-13, 
<a name="l00096"></a>00096 2.296d-13, 1.925d-13, 1.619d-13, 1.359d-13, 1.139d-13, 9.553d-14, 8.005d-14, 6.709d-14, 5.628d-14, 4.718d-14, 3.950d-14, 
<a name="l00097"></a>00097 3.317d-14, 2.774d-14, 2.323d-14, 1.946d-14, 1.633d-14, 1.367d-14, 1.147d-14, 9.601d-15, 8.044d-15, 6.741d-15, 5.653d-15, 
<a name="l00098"></a>00098 4.738d-15, 3.974d-15, 3.333d-15, 2.794d-15, 2.344d-15, 1.967d-15, 1.652d-15, 1.386d-15, 1.166d-15, 9.791d-16, 8.229d-16, 
<a name="l00099"></a>00099 6.913d-16, 5.810d-16, 4.888d-16, 4.112d-16, 3.457d-16, 2.911d-16, 2.451d-16, 2.064d-16, 1.738d-16, 1.465d-16, 1.235d-16, 
<a name="l00100"></a>00100 1.041d-16, 8.780d-17, 7.406d-17, 6.248d-17, 5.274d-17, 4.450d-17, 3.758d-17, 3.175d-17, 2.683d-17, 2.267d-17, 1.916d-17, 
<a name="l00101"></a>00101 1.620d-17, 1.371d-17, 1.159d-17, 9.814d-18, 8.305d-18, 7.032d-18, 5.953d-18, 5.045d-18, 4.276d-18, 3.620d-18, 3.066d-18, 
<a name="l00102"></a>00102 2.596d-18, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00103"></a>00103 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00104"></a>00104 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00105"></a>00105 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00106"></a>00106 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00107"></a>00107 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00108"></a>00108 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00109"></a>00109 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00110"></a>00110 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00111"></a>00111 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00112"></a>00112 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00113"></a>00113 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00114"></a>00114 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00115"></a>00115 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 
<a name="l00116"></a>00116 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00, 0.000d+00]
<a name="l00117"></a>00117 
<a name="l00118"></a><a class="code" href="namespacedust__temperature.html#a3196cf3f7cbf409eaf4cc983e96f5011">00118</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">dimension(nb_wavelengths)</span> :: Qabs = [
<a name="l00119"></a>00119 1.176d+00, 1.176d+00, 1.200d+00, 1.226d+00, 1.226d+00, 1.261d+00, 1.261d+00, 1.282d+00, 1.314d+00, 1.314d+00, 1.336d+00, 
<a name="l00120"></a>00120 1.336d+00, 1.345d+00, 1.343d+00, 1.343d+00, 1.405d+00, 1.405d+00, 1.420d+00, 1.332d+00, 1.332d+00, 1.151d+00, 1.151d+00, 
<a name="l00121"></a>00121 7.968d-01, 7.966d-01, 7.173d-01, 4.604d-01, 4.603d-01, 3.486d-01, 3.485d-01, 3.906d-01, 4.159d-01, 4.159d-01, 3.543d-01, 
<a name="l00122"></a>00122 3.542d-01, 2.850d-01, 2.556d-01, 2.556d-01, 2.548d-01, 2.548d-01, 2.626d-01, 2.584d-01, 2.584d-01, 2.355d-01, 2.355d-01, 
<a name="l00123"></a>00123 2.036d-01, 2.035d-01, 1.736d-01, 1.499d-01, 1.498d-01, 1.314d-01, 1.314d-01, 1.170d-01, 1.053d-01, 1.053d-01, 9.535d-02, 
<a name="l00124"></a>00124 9.532d-02, 8.668d-02, 7.903d-02, 7.901d-02, 7.223d-02, 7.221d-02, 6.614d-02, 6.066d-02, 6.064d-02, 5.572d-02, 5.569d-02, 
<a name="l00125"></a>00125 5.126d-02, 5.123d-02, 4.723d-02, 4.363d-02, 4.360d-02, 4.037d-02, 4.034d-02, 3.743d-02, 3.481d-02, 3.479d-02, 3.241d-02, 
<a name="l00126"></a>00126 3.239d-02, 3.033d-02, 2.846d-02, 2.843d-02, 2.672d-02, 2.669d-02, 2.511d-02, 2.366d-02, 2.362d-02, 2.233d-02, 2.229d-02, 
<a name="l00127"></a>00127 2.114d-02, 2.110d-02, 2.006d-02, 1.911d-02, 1.906d-02, 1.819d-02, 1.814d-02, 1.736d-02, 1.666d-02, 1.658d-02, 1.598d-02, 
<a name="l00128"></a>00128 1.586d-02, 1.540d-02, 2.652d-02, 1.920d-02, 1.378d-02, 1.400d-02, 1.351d-02, 1.361d-02, 1.305d-02, 1.253d-02, 1.259d-02, 
<a name="l00129"></a>00129 1.211d-02, 1.216d-02, 1.168d-02, 1.122d-02, 1.125d-02, 1.087d-02, 1.090d-02, 1.062d-02, 1.047d-02, 1.048d-02, 1.048d-02, 
<a name="l00130"></a>00130 1.048d-02, 1.065d-02, 1.090d-02, 1.089d-02, 1.094d-02, 1.094d-02, 1.104d-02, 1.104d-02, 1.412d-02, 3.264d-02, 3.187d-02, 
<a name="l00131"></a>00131 6.965d-02, 6.806d-02, 1.064d-01, 1.436d-01, 1.421d-01, 1.261d-01, 1.267d-01, 1.037d-01, 7.760d-02, 7.861d-02, 5.998d-02, 
<a name="l00132"></a>00132 6.071d-02, 4.526d-02, 3.397d-02, 3.440d-02, 2.872d-02, 2.893d-02, 3.232d-02, 3.220d-02, 3.812d-02, 4.472d-02, 4.448d-02, 
<a name="l00133"></a>00133 4.895d-02, 4.879d-02, 4.856d-02, 4.341d-02, 4.359d-02, 3.793d-02, 3.813d-02, 3.339d-02, 2.931d-02, 2.946d-02, 2.597d-02, 
<a name="l00134"></a>00134 2.610d-02, 2.294d-02, 2.023d-02, 2.033d-02, 1.798d-02, 1.806d-02, 1.593d-02, 1.601d-02, 1.417d-02, 1.262d-02, 1.268d-02, 
<a name="l00135"></a>00135 1.132d-02, 1.136d-02, 1.008d-02, 8.930d-03, 8.969d-03, 7.926d-03, 7.963d-03, 7.032d-03, 6.208d-03, 6.236d-03, 5.503d-03, 
<a name="l00136"></a>00136 5.529d-03, 4.873d-03, 4.294d-03, 4.313d-03, 3.802d-03, 3.820d-03, 3.364d-03, 3.380d-03, 2.979d-03, 2.624d-03, 2.637d-03, 
<a name="l00137"></a>00137 2.328d-03, 2.339d-03, 2.062d-03, 1.820d-03, 1.829d-03, 1.615d-03, 1.622d-03, 1.434d-03, 1.268d-03, 1.274d-03, 1.125d-03, 
<a name="l00138"></a>00138 1.131d-03, 1.002d-03, 8.864d-04, 8.903d-04, 7.885d-04, 7.920d-04, 7.016d-04, 7.047d-04, 6.243d-04, 5.534d-04, 5.558d-04, 
<a name="l00139"></a>00139 4.927d-04, 4.949d-04, 4.389d-04, 3.894d-04, 3.911d-04, 3.471d-04, 3.486d-04, 3.092d-04, 2.744d-04, 2.756d-04, 2.445d-04, 
<a name="l00140"></a>00140 2.456d-04, 2.180d-04, 1.935d-04, 1.943d-04, 1.726d-04, 1.733d-04, 1.539d-04, 1.546d-04, 1.372d-04, 1.218d-04, 1.224d-04, 
<a name="l00141"></a>00141 1.087d-04, 1.091d-04, 9.697d-05, 8.614d-05, 8.651d-05, 7.685d-05, 7.718d-05, 6.855d-05, 6.089d-05, 6.115d-05, 5.433d-05, 
<a name="l00142"></a>00142 5.457d-05, 4.848d-05, 4.869d-05, 4.325d-05, 3.843d-05, 3.859d-05, 3.429d-05, 3.444d-05, 3.060d-05, 2.719d-05, 2.730d-05, 
<a name="l00143"></a>00143 2.426d-05, 2.436d-05, 2.165d-05, 1.923d-05, 1.931d-05, 1.717d-05, 1.724d-05, 1.532d-05, 1.361d-05, 1.367d-05, 1.242d-05, 
<a name="l00144"></a>00144 1.160d-05, 1.083d-05, 1.011d-05, 9.443d-06, 8.817d-06, 8.232d-06, 7.686d-06, 7.177d-06, 6.701d-06, 6.257d-06, 5.842d-06, 
<a name="l00145"></a>00145 5.455d-06, 5.093d-06, 4.756d-06, 4.440d-06, 4.146d-06, 3.871d-06, 3.615d-06, 3.375d-06, 3.151d-06, 2.942d-06, 2.747d-06, 
<a name="l00146"></a>00146 2.565d-06, 2.395d-06, 2.236d-06, 2.088d-06, 1.950d-06, 1.820d-06, 1.700d-06, 1.587d-06, 1.482d-06, 1.384d-06, 1.292d-06, 
<a name="l00147"></a>00147 1.206d-06, 1.126d-06, 1.052d-06, 9.819d-07, 9.168d-07, 8.560d-07, 7.993d-07, 7.463d-07, 6.968d-07, 6.506d-07, 6.075d-07, 
<a name="l00148"></a>00148 5.672d-07, 5.296d-07, 4.945d-07, 4.617d-07, 4.311d-07, 4.025d-07, 3.759d-07, 3.509d-07, 3.277d-07, 3.060d-07, 2.857d-07, 
<a name="l00149"></a>00149 2.667d-07, 2.491d-07, 2.325d-07, 2.171d-07, 2.027d-07, 1.893d-07, 1.767d-07, 1.650d-07, 1.541d-07, 1.439d-07, 1.343d-07, 
<a name="l00150"></a>00150 1.254d-07, 1.171d-07, 1.094d-07, 1.021d-07, 9.534d-08, 8.902d-08, 8.312d-08, 7.761d-08, 7.246d-08, 6.766d-08, 6.317d-08, 
<a name="l00151"></a>00151 5.898d-08, 5.507d-08, 5.142d-08, 4.801d-08, 4.483d-08, 4.186d-08, 3.908d-08, 3.649d-08, 3.407d-08, 3.182d-08, 2.971d-08, 
<a name="l00152"></a>00152 2.774d-08, 2.590d-08, 2.418d-08, 2.258d-08, 2.108d-08, 1.968d-08, 1.838d-08, 1.716d-08, 1.602d-08, 1.496d-08, 1.397d-08, 
<a name="l00153"></a>00153 1.304d-08, 1.218d-08, 1.137d-08, 1.062d-08, 9.914d-09, 9.256d-09, 8.643d-09, 8.070d-09, 7.535d-09, 7.035d-09, 6.569d-09, 
<a name="l00154"></a>00154 6.134d-09, 5.727d-09, 5.347d-09, 4.993d-09, 4.662d-09, 4.353d-09, 4.064d-09, 3.795d-09, 3.543d-09, 3.308d-09, 3.089d-09, 
<a name="l00155"></a>00155 2.884d-09, 2.693d-09, 2.515d-09, 2.348d-09, 2.192d-09, 2.047d-09, 1.911d-09, 1.785d-09, 1.666d-09, 1.556d-09, 1.453d-09, 
<a name="l00156"></a>00156 1.356d-09, 1.266d-09, 1.182d-09, 1.104d-09, 1.031d-09, 9.626d-10, 8.987d-10, 8.392d-10, 7.835d-10, 7.316d-10, 6.831d-10, 
<a name="l00157"></a>00157 6.378d-10, 5.955d-10, 5.561d-10, 5.192d-10, 4.848d-10, 4.526d-10, 4.226d-10, 3.946d-10, 3.685d-10, 3.440d-10, 3.212d-10, 
<a name="l00158"></a>00158 2.999d-10, 2.800d-10, 2.615d-10, 2.441d-10, 2.280d-10, 2.129d-10, 1.987d-10, 1.856d-10, 1.733d-10, 1.618d-10, 1.511d-10, 
<a name="l00159"></a>00159 1.410d-10, 1.317d-10, 1.230d-10, 1.148d-10, 1.072d-10, 1.001d-10, 9.346d-11, 8.726d-11, 8.148d-11, 7.608d-11, 7.103d-11, 
<a name="l00160"></a>00160 6.632d-11, 6.193d-11, 5.782d-11, 5.399d-11, 5.041d-11, 4.707d-11, 4.395d-11, 4.103d-11, 3.831d-11, 3.577d-11, 3.340d-11, 
<a name="l00161"></a>00161 3.119d-11, 2.912d-11, 2.719d-11, 2.539d-11, 2.371d-11, 2.213d-11, 2.067d-11, 1.930d-11, 1.802d-11, 1.682d-11, 1.571d-11, 
<a name="l00162"></a>00162 1.467d-11, 1.369d-11, 1.279d-11, 1.194d-11, 1.115d-11, 1.041d-11, 9.718d-12, 9.074d-12, 8.473d-12, 7.911d-12, 7.387d-12, 
<a name="l00163"></a>00163 6.897d-12, 6.440d-12, 6.013d-12, 5.614d-12, 5.242d-12, 4.894d-12, 4.570d-12, 4.267d-12, 3.984d-12, 3.720d-12, 3.473d-12, 
<a name="l00164"></a>00164 3.243d-12, 3.028d-12, 2.827d-12, 2.640d-12, 2.465d-12]
<a name="l00165"></a>00165 
<a name="l00166"></a><a class="code" href="namespacedust__temperature.html#a66ee1432d7f578ac10950b5d47021981">00166</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">dimension(nb_wavelengths)</span> :: Iinc <span class="comment">!&lt; sum of the 4 composant in the incident flux, 3 parts of the spectrum, and dust</span>
<a name="l00167"></a><a class="code" href="namespacedust__temperature.html#a823eb1c29a2361c1bc74aa7f7bbde7f5">00167</a> <span class="keywordtype">real(double_precision)</span> :: rate_abs
<a name="l00168"></a>00168 
<a name="l00169"></a>00169 <span class="keywordtype">private</span>
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 <span class="keywordtype">public</span> :: <a class="code" href="namespacedust__temperature.html#a22b684d4dd420645d9af088f9cc28bcc">get_grain_temperature_computed</a> <span class="comment">!&lt; Only get_grain_temperature_computed routine will be available outside the module.</span>
<a name="l00172"></a>00172 
<a name="l00173"></a>00173 <span class="keyword">contains</span>
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="comment">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<a name="l00186"></a><a class="code" href="namespacedust__temperature.html#a22b684d4dd420645d9af088f9cc28bcc">00186</a> <span class="keyword">subroutine </span><a class="code" href="namespacedust__temperature.html#a22b684d4dd420645d9af088f9cc28bcc">get_grain_temperature_computed</a>(time, gas_temperature, grain_temperature)
<a name="l00187"></a>00187 
<a name="l00188"></a>00188 <span class="keyword">implicit none</span>
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 <span class="comment">! Inputs</span>
<a name="l00191"></a>00191 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">intent(in)</span> :: time <span class="comment">!&lt;[in] current time of the simulation [s]</span>
<a name="l00192"></a>00192 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">intent(in)</span> :: gas_temperature <span class="comment">!&lt;[in] gas temperature [K]</span>
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 <span class="comment">! Outputs</span>
<a name="l00195"></a>00195 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">intent(out)</span> :: grain_temperature <span class="comment">!&lt;[out] Steady state dust temperature [K]</span>
<a name="l00196"></a>00196 
<a name="l00197"></a>00197 <span class="comment">! Locals</span>
<a name="l00198"></a>00198 <span class="keywordtype">real(double_precision)</span> :: Tleft, Tright <span class="comment">! Temperature boundary</span>
<a name="l00199"></a>00199 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">parameter</span> :: eps = 1.0D-08 <span class="comment">! Tolerance</span>
<a name="l00200"></a>00200 <span class="keywordtype">real(double_precision)</span> :: fss <span class="comment">! Rq: fss should be equal to zero</span>
<a name="l00201"></a>00201 <span class="keywordtype">integer</span> :: etat <span class="comment">! flag</span>
<a name="l00202"></a>00202 
<a name="l00203"></a>00203 <span class="comment">!----</span>
<a name="l00204"></a>00204 <span class="comment">! Compute the incident radiation filed in term of specific</span>
<a name="l00205"></a>00205 <span class="comment">! intensity (erg cm-2 s-1 Angstrom-1 sr-1) after screening </span>
<a name="l00206"></a>00206 <span class="comment">! by dust</span>
<a name="l00207"></a>00207 call <a class="code" href="namespacedust__temperature.html#a1e7bf2929e970cc15fcc78311dbccfc2">compute_Iinc</a>(<a class="code" href="namespacedust__temperature.html#a74304c49ba26195db71939ab6eb16b38">wavelength</a>, <a class="code" href="namespacedust__temperature.html#a66ee1432d7f578ac10950b5d47021981">Iinc</a>)
<a name="l00208"></a>00208 
<a name="l00209"></a>00209 <span class="comment">!----</span>
<a name="l00210"></a>00210 <span class="comment">! Compute the absorption rate by dust</span>
<a name="l00211"></a>00211 call <a class="code" href="namespacedust__temperature.html#a2adc500d4c408295cc3112df6c558599">compute_abs</a>(<a class="code" href="namespacedust__temperature.html#a74304c49ba26195db71939ab6eb16b38">wavelength</a>, <a class="code" href="namespacedust__temperature.html#a66ee1432d7f578ac10950b5d47021981">Iinc</a>, <a class="code" href="namespacedust__temperature.html#a3196cf3f7cbf409eaf4cc983e96f5011">Qabs</a>, <a class="code" href="namespacedust__temperature.html#a823eb1c29a2361c1bc74aa7f7bbde7f5">rate_abs</a>)
<a name="l00212"></a>00212 
<a name="l00213"></a>00213 <span class="comment">!----</span>
<a name="l00214"></a>00214 <span class="comment">! Find the steady state dust temperature using a </span>
<a name="l00215"></a>00215 <span class="comment">! dichotomy algorithm.</span>
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 <span class="comment">! Temperature boundary</span>
<a name="l00218"></a>00218 Tleft = 2.73d00
<a name="l00219"></a>00219 Tright = 1.0d03
<a name="l00220"></a>00220 
<a name="l00221"></a>00221 call <a class="code" href="namespacedust__temperature.html#a92b230a057025899e6ffb6767018ecea">dicho</a>(Tleft, Tright, eps, grain_temperature, fss, etat)
<a name="l00222"></a>00222 
<a name="l00223"></a>00223 <span class="keyword">end subroutine get_grain_temperature_computed</span>
<a name="l00224"></a>00224 
<a name="l00225"></a>00225 <span class="comment">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<a name="l00237"></a><a class="code" href="namespacedust__temperature.html#a1e7bf2929e970cc15fcc78311dbccfc2">00237</a> <span class="keyword">subroutine </span><a class="code" href="namespacedust__temperature.html#a1e7bf2929e970cc15fcc78311dbccfc2">compute_Iinc</a>(x, Iout)
<a name="l00238"></a>00238 
<a name="l00239"></a>00239 <span class="keyword">implicit none</span>
<a name="l00240"></a>00240 
<a name="l00241"></a>00241 <span class="comment">! Inputs</span>
<a name="l00242"></a>00242 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">dimension(nb_wavelengths)</span>, <span class="keywordtype">intent(in)</span> :: x <span class="comment">!&lt;[in] Wavelength [Angstrom]</span>
<a name="l00243"></a>00243 
<a name="l00244"></a>00244 <span class="comment">! Outputs</span>
<a name="l00245"></a>00245 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">dimension(nb_wavelengths)</span>, <span class="keywordtype">intent(out)</span> :: Iout <span class="comment">!&lt;[out] Incident flux after dust screening [erg cm-2 s-1 Angstrom-1 sr-1]</span>
<a name="l00246"></a>00246 
<a name="l00247"></a>00247 <span class="comment">! Locals</span>
<a name="l00248"></a>00248 <span class="keywordtype">integer</span> :: i
<a name="l00249"></a>00249 <span class="keywordtype">real(double_precision)</span> :: Iin
<a name="l00250"></a>00250 
<a name="l00251"></a>00251 Iout = 0.d0
<a name="l00252"></a>00252 <span class="keyword">do</span> i=1, <a class="code" href="namespacedust__temperature.html#abc7667a19268b4a29cb6999c40295e0d">nb_wavelengths</a>
<a name="l00253"></a>00253    Iin = max(<a class="code" href="namespacedust__temperature.html#a37e5d6ae3aade018d041dbdf106e6128">get_local_UV_flux</a>(x(i)), <a class="code" href="namespacedust__temperature.html#a7f496b268572a9ab9ddf748fcc0859df">get_starlight_flux</a>(x(i)), <a class="code" href="namespacedust__temperature.html#a95dcd697e6ec3c7f9e968e3ff4bf0e9f">get_CMB_flux</a>(x(i)), <a class="code" href="namespacedust__temperature.html#ae51d0542c9255ad75448db1835866d24">incident_dust_flux</a>(i))
<a name="l00254"></a>00254    Iout(i) = Iin * 10.d0**(-<a class="code" href="namespacedust__temperature.html#ad5db51702b3ba85118fb7d03c6313002">ext</a>(x(i)) * <a class="code" href="namespaceglobal__variables.html#a70719d43ec2f69b5c28c61897ab75aab">visual_extinction</a> / 2.5d0)
<a name="l00255"></a>00255 <span class="keyword">enddo</span>
<a name="l00256"></a>00256 
<a name="l00257"></a>00257 
<a name="l00258"></a>00258 <span class="keyword">end subroutine compute_Iinc</span>
<a name="l00259"></a>00259 
<a name="l00260"></a>00260 <span class="comment">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<a name="l00270"></a><a class="code" href="namespacedust__temperature.html#a2adc500d4c408295cc3112df6c558599">00270</a> <span class="keyword">subroutine </span><a class="code" href="namespacedust__temperature.html#a2adc500d4c408295cc3112df6c558599">compute_abs</a>(x, Iin, Q, dustabs)
<a name="l00271"></a>00271 
<a name="l00272"></a>00272 <span class="keyword">implicit none</span>
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 <span class="comment">! Inputs</span>
<a name="l00275"></a>00275 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">dimension(nb_wavelengths)</span>, <span class="keywordtype">intent(in)</span> :: x
<a name="l00276"></a>00276 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">dimension(nb_wavelengths)</span>, <span class="keywordtype">intent(in)</span> :: Iin
<a name="l00277"></a>00277 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">dimension(nb_wavelengths)</span>, <span class="keywordtype">intent(in)</span> :: Q
<a name="l00278"></a>00278 
<a name="l00279"></a>00279 <span class="comment">! Outputs</span>
<a name="l00280"></a>00280 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">intent(out)</span> :: dustabs
<a name="l00281"></a>00281 
<a name="l00282"></a>00282 <span class="comment">! Locals</span>
<a name="l00283"></a>00283 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">dimension(nb_wavelengths)</span> :: Uin
<a name="l00284"></a>00284 <span class="keywordtype">real(double_precision)</span> :: sigmabs
<a name="l00285"></a>00285 <span class="keywordtype">real(double_precision)</span> :: test
<a name="l00286"></a>00286 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">dimension(nb_wavelengths)</span> :: Utest
<a name="l00287"></a>00287 <span class="keywordtype">integer</span> :: i
<a name="l00288"></a>00288 
<a name="l00289"></a>00289 <span class="comment">! --- Convert the specific intensity into specific energy density</span>
<a name="l00290"></a>00290 Uin = 4.0 * pi * Iin / <a class="code" href="namespaceglobal__variables.html#a0e18ef11765dad9808b3721d5212e8f6">SPEED_OF_LIGHT</a>
<a name="l00291"></a>00291 
<a name="l00292"></a>00292 <span class="comment">! --- Test: Compute the integrated energy density</span>
<a name="l00293"></a>00293 Utest=0.d0
<a name="l00294"></a>00294 <span class="keyword">do</span> i = 1, <a class="code" href="namespacedust__temperature.html#abc7667a19268b4a29cb6999c40295e0d">nb_wavelengths</a>
<a name="l00295"></a>00295    <span class="keyword">if</span>(x(i).ge.911.0 .AND. x(i).le. 2460.0) Utest(i) = Uin(i)
<a name="l00296"></a>00296 <span class="keyword">enddo</span>
<a name="l00297"></a>00297 
<a name="l00298"></a>00298 call <a class="code" href="namespacedust__temperature.html#ab85aa0c1db2b497466aa4d905c03d8a3">trap_int</a>(<a class="code" href="namespacedust__temperature.html#abc7667a19268b4a29cb6999c40295e0d">nb_wavelengths</a>, x, Utest, test)
<a name="l00299"></a>00299 
<a name="l00300"></a>00300 call <a class="code" href="namespacedust__temperature.html#ab85aa0c1db2b497466aa4d905c03d8a3">trap_int</a>(<a class="code" href="namespacedust__temperature.html#abc7667a19268b4a29cb6999c40295e0d">nb_wavelengths</a>, x, Uin, test)
<a name="l00301"></a>00301 <span class="comment">!---</span>
<a name="l00302"></a>00302 
<a name="l00303"></a>00303 <span class="comment">! --- Compute the heating rate by absorption of radiation</span>
<a name="l00304"></a>00304 call <a class="code" href="namespacedust__temperature.html#ab85aa0c1db2b497466aa4d905c03d8a3">trap_int</a>(<a class="code" href="namespacedust__temperature.html#abc7667a19268b4a29cb6999c40295e0d">nb_wavelengths</a>, x, Uin*Q, sigmabs)
<a name="l00305"></a>00305 dustabs = sigmabs * pi * <a class="code" href="namespaceglobal__variables.html#ad293e774768851488b5ef7ced6737d6e">grain_radius</a>**2 * <a class="code" href="namespaceglobal__variables.html#a0e18ef11765dad9808b3721d5212e8f6">SPEED_OF_LIGHT</a>
<a name="l00306"></a>00306 
<a name="l00307"></a>00307 <span class="keyword">end subroutine compute_abs</span>
<a name="l00308"></a>00308 
<a name="l00309"></a>00309 <span class="comment">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<a name="l00321"></a><a class="code" href="namespacedust__temperature.html#a8060e9d8cf69cb3521695f85f8627c7a">00321</a> <span class="keyword">real(double_precision)  </span><span class="keyword">function </span><a class="code" href="namespacedust__temperature.html#a8060e9d8cf69cb3521695f85f8627c7a">get_ss_grain</a>(Tss)
<a name="l00322"></a>00322 
<a name="l00323"></a>00323 <span class="keyword">implicit none</span>
<a name="l00324"></a>00324 
<a name="l00325"></a>00325 <span class="comment">! Inputs</span>
<a name="l00326"></a>00326 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">intent(in)</span> :: Tss
<a name="l00327"></a>00327 
<a name="l00328"></a>00328 <span class="comment">! Locals</span>
<a name="l00329"></a>00329 <span class="keywordtype">real(double_precision)</span> :: rate_emi
<a name="l00330"></a>00330 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">dimension(nb_wavelengths)</span> :: dustem
<a name="l00331"></a>00331 <span class="keywordtype">real(double_precision)</span> :: sigmaem
<a name="l00332"></a>00332 <span class="keywordtype">integer</span> :: i
<a name="l00333"></a>00333 
<a name="l00334"></a>00334 <span class="comment">! --- Compute the cooling rate by infrared emission</span>
<a name="l00335"></a>00335 <span class="keyword">do</span> i = 1, <a class="code" href="namespacedust__temperature.html#abc7667a19268b4a29cb6999c40295e0d">nb_wavelengths</a>
<a name="l00336"></a>00336    dustem(i) = <a class="code" href="namespacedust__temperature.html#af3c11422e69dbe76c7de961a8681214d">get_black_body_flux</a>(<a class="code" href="namespacedust__temperature.html#a74304c49ba26195db71939ab6eb16b38">wavelength</a>(i), Tss)
<a name="l00337"></a>00337 <span class="keyword">enddo</span>
<a name="l00338"></a>00338 
<a name="l00339"></a>00339 call <a class="code" href="namespacedust__temperature.html#ab85aa0c1db2b497466aa4d905c03d8a3">trap_int</a>(<a class="code" href="namespacedust__temperature.html#abc7667a19268b4a29cb6999c40295e0d">nb_wavelengths</a>, <a class="code" href="namespacedust__temperature.html#a74304c49ba26195db71939ab6eb16b38">wavelength</a>, dustem*<a class="code" href="namespacedust__temperature.html#a3196cf3f7cbf409eaf4cc983e96f5011">Qabs</a>, sigmaem)
<a name="l00340"></a>00340 rate_emi = 4.d0 * pi**2 * <a class="code" href="namespaceglobal__variables.html#ad293e774768851488b5ef7ced6737d6e">grain_radius</a>**2 * sigmaem
<a name="l00341"></a>00341 
<a name="l00342"></a>00342 <span class="comment">! --- cooling balance heating</span>
<a name="l00343"></a>00343 <a class="code" href="namespacedust__temperature.html#a8060e9d8cf69cb3521695f85f8627c7a">get_ss_grain</a> = rate_emi - <a class="code" href="namespacedust__temperature.html#a823eb1c29a2361c1bc74aa7f7bbde7f5">rate_abs</a>
<a name="l00344"></a>00344 
<a name="l00345"></a>00345 <span class="keyword">end function get_ss_grain</span>
<a name="l00346"></a>00346 
<a name="l00347"></a>00347 <span class="comment">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<a name="l00363"></a><a class="code" href="namespacedust__temperature.html#a37e5d6ae3aade018d041dbdf106e6128">00363</a> <span class="keyword">real(double_precision) </span><span class="keyword">function  </span><a class="code" href="namespacedust__temperature.html#a37e5d6ae3aade018d041dbdf106e6128">get_local_UV_flux</a>(x)
<a name="l00364"></a>00364 
<a name="l00365"></a>00365 <span class="keyword">implicit none</span>
<a name="l00366"></a>00366 
<a name="l00367"></a>00367 <span class="comment">! Inputs</span>
<a name="l00368"></a>00368 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">intent(in)</span> :: x <span class="comment">!&lt;[in] Wavelength (Angstrom)</span>
<a name="l00369"></a>00369 
<a name="l00370"></a>00370 <span class="keyword">if</span> (x .GE. 1340.0 .AND. x .LT. 2460.0) <span class="keyword">then</span>
<a name="l00371"></a>00371    <a class="code" href="namespacedust__temperature.html#a37e5d6ae3aade018d041dbdf106e6128">get_local_UV_flux</a> = 2.373D-14 * (x/1e4)**(-0.6678)
<a name="l00372"></a>00372 elseif (x .GE. 1100.0 .AND. x .LT. 1340.0) <span class="keyword">then</span>
<a name="l00373"></a>00373    <a class="code" href="namespacedust__temperature.html#a37e5d6ae3aade018d041dbdf106e6128">get_local_UV_flux</a> = 6.825D-13*(x/1e4)
<a name="l00374"></a>00374 elseif (x .GE. 912.0 .AND. x .LT. 1100.0) <span class="keyword">then</span>
<a name="l00375"></a>00375    <a class="code" href="namespacedust__temperature.html#a37e5d6ae3aade018d041dbdf106e6128">get_local_UV_flux</a> = 1.287D-9 * (x/1e4)**(4.4172)
<a name="l00376"></a>00376 <span class="keyword">else</span>
<a name="l00377"></a>00377    <a class="code" href="namespacedust__temperature.html#a37e5d6ae3aade018d041dbdf106e6128">get_local_UV_flux</a> = 0.0d00
<a name="l00378"></a>00378 <span class="keyword">endif</span>
<a name="l00379"></a>00379 
<a name="l00380"></a>00380 <a class="code" href="namespacedust__temperature.html#a37e5d6ae3aade018d041dbdf106e6128">get_local_UV_flux</a> = <a class="code" href="namespacedust__temperature.html#a37e5d6ae3aade018d041dbdf106e6128">get_local_UV_flux</a> * <a class="code" href="namespaceglobal__variables.html#a0e18ef11765dad9808b3721d5212e8f6">SPEED_OF_LIGHT</a> / (4.d0*pi) / x * <a class="code" href="namespaceglobal__variables.html#a22c25f3a7738bb754b2da9a33197668b">UV_FLUX</a>
<a name="l00381"></a>00381 
<a name="l00382"></a>00382 <span class="keyword">end function get_local_UV_flux</span>
<a name="l00383"></a>00383 
<a name="l00384"></a>00384 <span class="comment">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<a name="l00400"></a><a class="code" href="namespacedust__temperature.html#a7f496b268572a9ab9ddf748fcc0859df">00400</a> <span class="keyword">real(double_precision) </span><span class="keyword">function  </span><a class="code" href="namespacedust__temperature.html#a7f496b268572a9ab9ddf748fcc0859df">get_starlight_flux</a>(x)
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 <span class="keyword">implicit none</span>
<a name="l00403"></a>00403 
<a name="l00404"></a>00404 <span class="comment">! Inputs</span>
<a name="l00405"></a>00405 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">intent(in)</span> :: x <span class="comment">!&lt;[in] Wavelength (Angstrom)</span>
<a name="l00406"></a>00406 
<a name="l00407"></a>00407 <a class="code" href="namespacedust__temperature.html#a7f496b268572a9ab9ddf748fcc0859df">get_starlight_flux</a> =  1.0<a class="code" href="namespacedust__temperature.html#a01e79d121184f37a69f5d54208a8b8e2">d</a>-14*<a class="code" href="namespacedust__temperature.html#af3c11422e69dbe76c7de961a8681214d">get_black_body_flux</a>(x, 7500.d0) &amp;
<a name="l00408"></a>00408        + 1.0<a class="code" href="namespacedust__temperature.html#a01e79d121184f37a69f5d54208a8b8e2">d</a>-13*<a class="code" href="namespacedust__temperature.html#af3c11422e69dbe76c7de961a8681214d">get_black_body_flux</a>(x, 4000.d0) &amp;
<a name="l00409"></a>00409        + 4.0<a class="code" href="namespacedust__temperature.html#a01e79d121184f37a69f5d54208a8b8e2">d</a>-13*<a class="code" href="namespacedust__temperature.html#af3c11422e69dbe76c7de961a8681214d">get_black_body_flux</a>(x, 3000.d0)
<a name="l00410"></a>00410 
<a name="l00411"></a>00411 <span class="keyword">end function get_starlight_flux</span>
<a name="l00412"></a>00412 
<a name="l00413"></a>00413 <span class="comment">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<a name="l00428"></a><a class="code" href="namespacedust__temperature.html#a95dcd697e6ec3c7f9e968e3ff4bf0e9f">00428</a> <span class="keyword">real(double_precision) </span><span class="keyword">function  </span><a class="code" href="namespacedust__temperature.html#a95dcd697e6ec3c7f9e968e3ff4bf0e9f">get_CMB_flux</a>(x)
<a name="l00429"></a>00429 
<a name="l00430"></a>00430 <span class="keyword">implicit none</span>
<a name="l00431"></a>00431 
<a name="l00432"></a>00432 <span class="comment">! Inputs</span>
<a name="l00433"></a>00433 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">intent(in)</span> :: x <span class="comment">!&lt;[in] Wavelength (Angstrom)</span>
<a name="l00434"></a>00434 
<a name="l00435"></a>00435 <a class="code" href="namespacedust__temperature.html#a95dcd697e6ec3c7f9e968e3ff4bf0e9f">get_CMB_flux</a> = <a class="code" href="namespacedust__temperature.html#af3c11422e69dbe76c7de961a8681214d">get_black_body_flux</a>(x, 2.725d0)
<a name="l00436"></a>00436 
<a name="l00437"></a>00437 <span class="keyword">end function get_CMB_flux</span>
<a name="l00438"></a>00438 
<a name="l00439"></a>00439 <span class="comment">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<a name="l00452"></a><a class="code" href="namespacedust__temperature.html#af3c11422e69dbe76c7de961a8681214d">00452</a> <span class="keyword">real(double_precision) </span><span class="keyword">function  </span><a class="code" href="namespacedust__temperature.html#af3c11422e69dbe76c7de961a8681214d">get_black_body_flux</a>(x, T)
<a name="l00453"></a>00453 
<a name="l00454"></a>00454 <span class="keyword">implicit none</span>
<a name="l00455"></a>00455 
<a name="l00456"></a>00456 <span class="comment">! Inputs</span>
<a name="l00457"></a>00457 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">intent(in)</span> :: x <span class="comment">!&lt;[in] Wavelength  [Angstrom]</span>
<a name="l00458"></a>00458 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">intent(in)</span> :: T <span class="comment">!&lt;[in] Temperature [K]</span>
<a name="l00459"></a>00459 
<a name="l00460"></a>00460 <a class="code" href="namespacedust__temperature.html#af3c11422e69dbe76c7de961a8681214d">get_black_body_flux</a> = 2.d0 * <a class="code" href="namespaceglobal__variables.html#aa73e012bfb68a41d211377410b3eea8b">PLANCK_CONSTANT</a> * <a class="code" href="namespaceglobal__variables.html#a0e18ef11765dad9808b3721d5212e8f6">SPEED_OF_LIGHT</a>**2 * 1.0d32 / &amp;
<a name="l00461"></a>00461        (x**5 * (exp((<a class="code" href="namespaceglobal__variables.html#aa73e012bfb68a41d211377410b3eea8b">PLANCK_CONSTANT</a>*<a class="code" href="namespaceglobal__variables.html#a0e18ef11765dad9808b3721d5212e8f6">SPEED_OF_LIGHT</a>/<a class="code" href="namespaceglobal__variables.html#ad428addcbc6fd59652dcb82d94a9e80c">K_B</a>)*1.0d8 / (x*T)) - 1.d0))
<a name="l00462"></a>00462 
<a name="l00463"></a>00463 <span class="keyword">end function get_black_body_flux</span>
<a name="l00464"></a>00464 <span class="comment">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<a name="l00465"></a>00465 
<a name="l00466"></a>00466 
<a name="l00467"></a>00467 <span class="comment">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<a name="l00481"></a><a class="code" href="namespacedust__temperature.html#ad5db51702b3ba85118fb7d03c6313002">00481</a> <span class="keyword">real(double_precision) </span><span class="keyword">function  </span><a class="code" href="namespacedust__temperature.html#ad5db51702b3ba85118fb7d03c6313002">ext</a>(wl)
<a name="l00482"></a>00482 
<a name="l00483"></a>00483 <span class="keyword">implicit none</span>
<a name="l00484"></a>00484 
<a name="l00485"></a>00485 <span class="comment">! Inputs</span>
<a name="l00486"></a>00486 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">intent(in)</span> :: wl <span class="comment">!&lt; Wavelength [Angstrom]</span>
<a name="l00487"></a>00487 
<a name="l00488"></a>00488 <span class="comment">! Locals</span>
<a name="l00489"></a>00489 <span class="keywordtype">real(double_precision)</span> :: x
<a name="l00490"></a>00490 <span class="keywordtype">real(double_precision)</span> :: a, b, fa, fb, y
<a name="l00491"></a>00491 
<a name="l00492"></a>00492 <span class="comment">! convert x which is in Angstrom to micrometer-1</span>
<a name="l00493"></a>00493 x = 1.0e4/wl
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 a = 0.d0
<a name="l00496"></a>00496 b = 0.d0
<a name="l00497"></a>00497 <span class="comment">! --- Infrared: 0.0 to 1.4 micrometer-1</span>
<a name="l00498"></a>00498 <span class="keyword">if</span>(x .lt. 1.4) <span class="keyword">then</span>
<a name="l00499"></a>00499    a =  0.574 * x**1.61
<a name="l00500"></a>00500    b = -0.527 * x**1.61
<a name="l00501"></a>00501 <span class="comment">! Optical/NIR: 1.4 to 2.7 micrometer-1</span>
<a name="l00502"></a>00502 elseif(x .ge. 1.4 .and. x .le. 2.7) <span class="keyword">then</span>
<a name="l00503"></a>00503   y = x - 1.82
<a name="l00504"></a>00504   a = 1.00 + 0.17699*y - 0.50447*y**2 - 0.02427*y**3 + 0.72085*y**4 + &amp;
<a name="l00505"></a>00505       0.01979*y**5 - 0.77530*y**6 + 0.32999*y**7
<a name="l00506"></a>00506   b = 1.41338*y + 2.28305*y**2 + 1.07233*y**3 - 5.38434*y**4 - &amp;
<a name="l00507"></a>00507       0.62251*y**5 + 5.30260*y**5 - 2.09002*y**7
<a name="l00508"></a>00508 <span class="comment">! UV: 2.7 to 8.0 micrometer-1</span>
<a name="l00509"></a>00509 elseif(x .ge. 2.7 .and. x .le. 8.0) <span class="keyword">then</span>
<a name="l00510"></a>00510   <span class="keyword">if</span>(x .ge. 5.9 .and. x .le. 8.0) <span class="keyword">then</span>
<a name="l00511"></a>00511      fa = -0.04473*(x-5.9)**2 - 0.009779*(x-5.9)**3
<a name="l00512"></a>00512      fb =  0.2130*(x-5.9)**2 + 0.1207*(x-5.9)**3
<a name="l00513"></a>00513   elseif(x .le. 5.9) <span class="keyword">then</span>
<a name="l00514"></a>00514      fa = 0.d0
<a name="l00515"></a>00515      fb = 0.d0
<a name="l00516"></a>00516   <span class="keyword">endif</span>
<a name="l00517"></a>00517   a = 1.752 - 0.316*x - 0.104/((x-4.47)**2 + 0.341) + fa
<a name="l00518"></a>00518   b = -3.090 + 1.825*x + 1.206/((x-4.62)**2 + 0.263) + fb
<a name="l00519"></a>00519 <span class="comment">! Far-UV: 8.0 to ...  micrometer-1</span>
<a name="l00520"></a>00520 elseif(x .ge. 8.0) <span class="keyword">then</span>
<a name="l00521"></a>00521   a = -1.073 - 0.628*(x-8.0) + 0.137*(x-8.0)**2 - 0.070*(x-8.0)**3
<a name="l00522"></a>00522   b = 13.670 + 4.257*(x-8.0) - 0.420*(x-8.0)**2 + 0.374*(x-8.0)**3
<a name="l00523"></a>00523 <span class="keyword">endif</span>
<a name="l00524"></a>00524 
<a name="l00525"></a>00525 <a class="code" href="namespacedust__temperature.html#ad5db51702b3ba85118fb7d03c6313002">ext</a> = a + b/3.1
<a name="l00526"></a>00526 
<a name="l00527"></a>00527 <span class="keyword">end function ext</span>
<a name="l00528"></a>00528 
<a name="l00529"></a>00529 <span class="comment">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<a name="l00539"></a><a class="code" href="namespacedust__temperature.html#ab85aa0c1db2b497466aa4d905c03d8a3">00539</a> <span class="keyword">subroutine </span><a class="code" href="namespacedust__temperature.html#ab85aa0c1db2b497466aa4d905c03d8a3">trap_int</a>(n, x, f, res)
<a name="l00540"></a>00540 
<a name="l00541"></a>00541 <span class="keyword">implicit none</span>
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 <span class="comment">! Inputs</span>
<a name="l00544"></a>00544 <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: n
<a name="l00545"></a>00545 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">dimension(n)</span>, <span class="keywordtype">intent(in)</span> :: x, f
<a name="l00546"></a>00546 
<a name="l00547"></a>00547 <span class="comment">! Outputs</span>
<a name="l00548"></a>00548 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">intent(out)</span> :: res
<a name="l00549"></a>00549 
<a name="l00550"></a>00550 <span class="comment">! Locals</span>
<a name="l00551"></a>00551 <span class="keywordtype">integer</span> :: i
<a name="l00552"></a>00552 <span class="keywordtype">real(double_precision)</span> :: h, int
<a name="l00553"></a>00553 
<a name="l00554"></a>00554 res = 0.d0
<a name="l00555"></a>00555 int = 0.d0
<a name="l00556"></a>00556 
<a name="l00557"></a>00557 <span class="keyword">do</span> i=1, n-1
<a name="l00558"></a>00558   h = abs((x(i+1) - x(i))/2.0)
<a name="l00559"></a>00559   int = h * (f(i) + f(i+1))
<a name="l00560"></a>00560   res = res + int
<a name="l00561"></a>00561 <span class="keyword">enddo</span>
<a name="l00562"></a>00562 
<a name="l00563"></a>00563 <span class="keyword">end subroutine trap_int</span>
<a name="l00564"></a>00564 
<a name="l00565"></a>00565 <span class="comment">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<a name="l00575"></a><a class="code" href="namespacedust__temperature.html#a92b230a057025899e6ffb6767018ecea">00575</a> <span class="keyword">subroutine </span><a class="code" href="namespacedust__temperature.html#a92b230a057025899e6ffb6767018ecea">dicho</a>(xl_in, xr_in, eps_in, xtry, ftry, etat)
<a name="l00576"></a>00576 
<a name="l00577"></a>00577 <span class="keyword">implicit none</span>
<a name="l00578"></a>00578 
<a name="l00579"></a>00579 <span class="comment">! Inputs</span>
<a name="l00580"></a>00580 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">intent(in)</span> :: xl_in, xr_in <span class="comment">!&lt;[in] Borne gauche et droite initiale</span>
<a name="l00581"></a>00581 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">intent(in)</span> :: eps_in <span class="comment">!&lt;[in] Precision</span>
<a name="l00582"></a>00582 
<a name="l00583"></a>00583 <span class="comment">! Outputs</span>
<a name="l00584"></a>00584 <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">intent(out)</span> :: xtry, ftry <span class="comment">!&lt;[out] Point milieu</span>
<a name="l00585"></a>00585 <span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span>:: etat <span class="comment">!&lt;[out] Flag</span>
<a name="l00586"></a>00586 
<a name="l00587"></a>00587 <span class="comment">! Locals</span>
<a name="l00588"></a>00588 <span class="keywordtype">real(double_precision)</span> :: xl, xr <span class="comment">! Borne gauche et droite</span>
<a name="l00589"></a>00589 <span class="keywordtype">real(double_precision)</span> :: fl, fr <span class="comment">! f(xl) et f(xr)</span>
<a name="l00590"></a>00590 <span class="keywordtype">real(double_precision)</span> :: dxrel <span class="comment">! Variation</span>
<a name="l00591"></a>00591 <span class="keywordtype">integer</span> :: i <span class="comment">! Compteur</span>
<a name="l00592"></a>00592 <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: imax = 10000
<a name="l00593"></a>00593 
<a name="l00594"></a>00594 <span class="comment">!--- Initialisation</span>
<a name="l00595"></a>00595 
<a name="l00596"></a>00596 xl = xl_in
<a name="l00597"></a>00597 xr = xr_in
<a name="l00598"></a>00598 
<a name="l00599"></a>00599 fl = <a class="code" href="namespacedust__temperature.html#a8060e9d8cf69cb3521695f85f8627c7a">get_ss_grain</a>(xl)
<a name="l00600"></a>00600 fr = <a class="code" href="namespacedust__temperature.html#a8060e9d8cf69cb3521695f85f8627c7a">get_ss_grain</a>(xr)
<a name="l00601"></a>00601 
<a name="l00602"></a>00602 <span class="comment">!--- consistency test</span>
<a name="l00603"></a>00603 <span class="keyword">if</span> (xl &gt;= xr) <span class="keyword">then</span>
<a name="l00604"></a>00604    <span class="keyword">write</span>(Error_unit,*) <span class="stringliteral">&quot;Error: In dust_temperature:dicho&quot;</span>
<a name="l00605"></a>00605    <span class="keyword">write</span>(Error_unit,*) <span class="stringliteral">&quot;We need xl &lt; xr but xl=&quot;</span>, xl, <span class="stringliteral">&quot; and xr=&quot;</span>, xr
<a name="l00606"></a>00606    stop
<a name="l00607"></a>00607 <span class="keyword">endif</span>
<a name="l00608"></a>00608 
<a name="l00609"></a>00609 <span class="keyword">if</span> (fl*fr &lt; 0.0d00) <span class="keyword">then</span> <span class="comment">! The zero is between xl and xr</span>
<a name="l00610"></a>00610    etat = 0 <span class="comment">! No solution found yet</span>
<a name="l00611"></a>00611    i    = 0
<a name="l00612"></a>00612    <span class="keyword">do</span> <span class="keyword">while</span> (etat == 0)
<a name="l00613"></a>00613       i = i + 1
<a name="l00614"></a>00614       xtry = 0.5d00 * (xl + xr)
<a name="l00615"></a>00615       ftry = <a class="code" href="namespacedust__temperature.html#a8060e9d8cf69cb3521695f85f8627c7a">get_ss_grain</a>(xtry)
<a name="l00616"></a>00616       <span class="keyword">if</span> (fl*ftry &gt; 0.0d00) <span class="keyword">then</span>
<a name="l00617"></a>00617          xl = xtry
<a name="l00618"></a>00618          fl = ftry
<a name="l00619"></a>00619       <span class="keyword">else</span>
<a name="l00620"></a>00620          xr = xtry
<a name="l00621"></a>00621          fr = ftry
<a name="l00622"></a>00622       <span class="keyword">endif</span>
<a name="l00623"></a>00623 
<a name="l00624"></a>00624 
<a name="l00625"></a>00625       <span class="keyword">if</span> (xtry /= 0.0d00) <span class="keyword">then</span>
<a name="l00626"></a>00626          dxrel = ABS((xr-xl)/xtry)
<a name="l00627"></a>00627       <span class="keyword">else</span>
<a name="l00628"></a>00628          dxrel = ABS(xr-xl)
<a name="l00629"></a>00629       <span class="keyword">endif</span>
<a name="l00630"></a>00630       <span class="keyword">if</span> (dxrel &lt; eps_in .AND. ABS(ftry) &lt; eps_in) <span class="keyword">then</span>
<a name="l00631"></a>00631          etat = 1
<a name="l00632"></a>00632       <span class="keyword">else</span> <span class="keyword">if</span> (i &gt; imax) <span class="keyword">then</span>
<a name="l00633"></a>00633          etat = 2
<a name="l00634"></a>00634       <span class="keyword">endif</span>
<a name="l00635"></a>00635    <span class="keyword">enddo</span>
<a name="l00636"></a>00636 
<a name="l00637"></a>00637 <span class="keyword">else</span>
<a name="l00638"></a>00638    etat = 3
<a name="l00639"></a>00639 <span class="keyword">endif</span>
<a name="l00640"></a>00640 
<a name="l00641"></a>00641 <span class="keyword">if</span> (etat == 3) <span class="keyword">then</span>
<a name="l00642"></a>00642    <span class="keyword">write</span>(Error_unit, *) <span class="stringliteral">&quot; &quot;</span>
<a name="l00643"></a>00643    <span class="keyword">write</span>(Error_unit, *) <span class="stringliteral">&quot;--------------------------------------------------------  &quot;</span>
<a name="l00644"></a>00644    <span class="keyword">write</span>(Error_unit, *) <span class="stringliteral">&quot; Error in subroutine DICHO of dust_temperature.f90:&quot;</span>
<a name="l00645"></a>00645    <span class="keyword">write</span>(Error_unit, *) <span class="stringliteral">&quot; the sign of the function doesn&#39;t change in the interval:&quot;</span>
<a name="l00646"></a>00646    <span class="keyword">write</span>(Error_unit, *) <span class="stringliteral">&quot; x(left)  :&quot;</span>, xl, <span class="stringliteral">&quot; f(left)   :&quot;</span>, fl
<a name="l00647"></a>00647    <span class="keyword">write</span>(Error_unit, *) <span class="stringliteral">&quot; x(right) :&quot;</span>, xr, <span class="stringliteral">&quot; f(right)  :&quot;</span>, fr
<a name="l00648"></a>00648    <span class="keyword">write</span>(Error_unit, *) <span class="stringliteral">&quot;--------------------------------------------------------  &quot;</span>
<a name="l00649"></a>00649    <span class="keyword">write</span>(Error_unit, *) <span class="stringliteral">&quot; &quot;</span>
<a name="l00650"></a>00650    call exit(11)
<a name="l00651"></a>00651 <span class="keyword">endif</span>
<a name="l00652"></a>00652 
<a name="l00653"></a>00653 <span class="keyword">end subroutine dicho</span>
<a name="l00654"></a>00654 
<a name="l00655"></a>00655 <span class="keyword">end module dust_temperature</span>
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed May 28 2014 for <a href= http://code.google.com/p/nautilus/>Nautilus</a> by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
