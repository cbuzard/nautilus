<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Nautilus: global_variables.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Nautilus</div>
   <div id="projectbrief">1D gas-grain chemical model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">global_variables.f90</div>  </div>
</div>
<div class="contents">
<a href="global__variables_8f90.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">!******************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">! MODULE: global_variables</span>
<a name="l00003"></a>00003 <span class="comment">!******************************************************************************</span>
<a name="l00004"></a>00004 <span class="comment">!</span>
<a name="l00005"></a>00005 <span class="comment">! DESCRIPTION: </span>
<a name="l00009"></a>00009 
<a name="l00010"></a><a class="code" href="namespaceglobal__variables.html">00010</a> <span class="keyword">module</span> global_variables
<a name="l00011"></a>00011 use <span class="keywordflow">numerical_types</span>
<a name="l00012"></a>00012 use <span class="keywordflow">iso_fortran_env</span>
<a name="l00013"></a>00013 use <span class="keywordflow">utilities</span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="keyword">implicit none</span>
<a name="l00016"></a><a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">00016</a> <span class="keywordtype">integer</span> :: nb_reactions <span class="comment">!&lt; total number of reactions</span>
<a name="l00017"></a><a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">00017</a> <span class="keywordtype">integer</span> :: nb_species <span class="comment">!&lt; total number of species</span>
<a name="l00018"></a><a class="code" href="namespaceglobal__variables.html#a92f61eb7a88fe738db011101272fe3c2">00018</a> <span class="keywordtype">integer</span> :: nb_gaseous_species <span class="comment">!&lt; number of species that are gaseous</span>
<a name="l00019"></a><a class="code" href="namespaceglobal__variables.html#a30928fefa37dcaeca6630b0fc4ec8a9a">00019</a> <span class="keywordtype">integer</span> :: nb_surface_species <span class="comment">!&lt; number of species that are on the surface of grains</span>
<a name="l00020"></a><a class="code" href="namespaceglobal__variables.html#a2aa4be5d11df79c25e4b2474494dc0b7">00020</a> <span class="keywordtype">integer</span> :: NB_PRIME_ELEMENTS <span class="comment">!&lt; Number of prime element that compose molecules, such as H, He, C and so on.</span>
<a name="l00021"></a><a class="code" href="namespaceglobal__variables.html#a123983c27b5980f7064915557e53f63a">00021</a> <span class="keywordtype">integer</span> :: nb_species_for_grain <span class="comment">!&lt; number of species involved in grain surface reactions (can be gas or grain phase elements)</span>
<a name="l00022"></a><a class="code" href="namespaceglobal__variables.html#a7776be480fd35a80eb7077912c2ff212">00022</a> <span class="keywordtype">integer</span> :: nb_surface_reactions <span class="comment">!&lt; number of reactions on the grain surface</span>
<a name="l00023"></a><a class="code" href="namespaceglobal__variables.html#a9eb4858dc86bcaf6f75a2b2a77786097">00023</a> <span class="keywordtype">integer</span> :: nb_species_for_gas <span class="comment">!&lt; number of species involved in gas phase reactions (can be gas or grain phase elements)</span>
<a name="l00024"></a><a class="code" href="namespaceglobal__variables.html#a1386249b61536332c06b75ca9fd9ed45">00024</a> <span class="keywordtype">integer</span> :: nb_gas_phase_reactions <span class="comment">!&lt; number of reactions in gas phase</span>
<a name="l00025"></a><a class="code" href="namespaceglobal__variables.html#a6623b4104772161e3879f413cba30c77">00025</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">parameter</span> :: MINIMUM_RATE_COEFFICIENT=1.0D-99 <span class="comment">!&lt; Minimum rate coefficient (Below, coefficients are forced to 0)</span>
<a name="l00026"></a><a class="code" href="namespaceglobal__variables.html#ad428addcbc6fd59652dcb82d94a9e80c">00026</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">parameter</span> :: K_B = 1.3806488d-16 <span class="comment">!&lt; Boltzmann constant in CGS (cm^2 g s^‚Åª2 K-1)</span>
<a name="l00027"></a><a class="code" href="namespaceglobal__variables.html#ade52f4b5131242a3e0d9cdbd01c31454">00027</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">parameter</span> :: PI = 3.1415926535898d0 <span class="comment">!&lt; The number Pi</span>
<a name="l00028"></a><a class="code" href="namespaceglobal__variables.html#a0aa2ce6d6426d346a83a63f513cc983d">00028</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">parameter</span> :: H_BARRE = 1.054571628d-27 <span class="comment">!&lt; Reduced Planck constant h/2*pi in CGS (g cm2 s-1)</span>
<a name="l00029"></a><a class="code" href="namespaceglobal__variables.html#ac98465068501006867a351f3442a54aa">00029</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">parameter</span> :: AMU = 1.66053892d-24 <span class="comment">!&lt; Atomic mass unit in g</span>
<a name="l00030"></a><a class="code" href="namespaceglobal__variables.html#a00715a907f80b996b794136a146f7f05">00030</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">parameter</span> :: AVOGADRO = 6.02214129d23 <span class="comment">!&lt; avogadro number : number of atom in 1 mol</span>
<a name="l00031"></a><a class="code" href="namespaceglobal__variables.html#a8d10fc5e3e9e9679f1f0b9178c899387">00031</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">parameter</span> :: YEAR = 3.15576d7 <span class="comment">!&lt; one year in seconds</span>
<a name="l00032"></a><a class="code" href="namespaceglobal__variables.html#abb5ae9b5779a910c5d78d245435d2edf">00032</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">parameter</span> :: AU = 1.49597871d13 <span class="comment">!&lt; Astronomical unit in cm (mean earth-sun distance)</span>
<a name="l00033"></a>00033 
<a name="l00034"></a><a class="code" href="namespaceglobal__variables.html#ac1549f09602f380996ba7fd9a83b9c93">00034</a> <span class="keywordtype">real(double_precision)</span> :: RELATIVE_TOLERANCE
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="comment">! Name of key species</span>
<a name="l00037"></a><a class="code" href="namespaceglobal__variables.html#a6135b1b63efaf1e7c7f237ae51550ad2">00037</a> <span class="keywordtype">character(len=11)</span> :: YH     = <span class="stringliteral">&#39;H          &#39;</span> <span class="comment">!&lt; Gas phase Hydrogen</span>
<a name="l00038"></a><a class="code" href="namespaceglobal__variables.html#ac482cca882b0a18a0ff5036b6c1f28f6">00038</a> <span class="keywordtype">character(len=11)</span> :: YJH    = <span class="stringliteral">&#39;JH         &#39;</span> <span class="comment">!&lt; Hydrogen on grains</span>
<a name="l00039"></a><a class="code" href="namespaceglobal__variables.html#a332b8c2284d5cc1745d4ca18c15b0e94">00039</a> <span class="keywordtype">character(len=11)</span> :: YH2    = <span class="stringliteral">&#39;H2         &#39;</span> <span class="comment">!&lt; Gas phase Dihydrogen</span>
<a name="l00040"></a><a class="code" href="namespaceglobal__variables.html#a440f32b1e4e9ec4a4e326ddf7bf38786">00040</a> <span class="keywordtype">character(len=11)</span> :: YJH2   = <span class="stringliteral">&#39;JH2        &#39;</span> <span class="comment">!&lt; Dihydrogen on grains</span>
<a name="l00041"></a><a class="code" href="namespaceglobal__variables.html#a30f14832638325575efebce96a717ef1">00041</a> <span class="keywordtype">character(len=11)</span> :: YHE    = <span class="stringliteral">&#39;He         &#39;</span> <span class="comment">!&lt; Gas phase Helium</span>
<a name="l00042"></a><a class="code" href="namespaceglobal__variables.html#a15d68c09d49a8157a079e648ff231ac2">00042</a> <span class="keywordtype">character(len=11)</span> :: YHEP   = <span class="stringliteral">&#39;He+        &#39;</span> <span class="comment">!&lt; Gas phase Helium+</span>
<a name="l00043"></a><a class="code" href="namespaceglobal__variables.html#a9844e29893348568c3949ba625544048">00043</a> <span class="keywordtype">character(len=11)</span> :: YE     = <span class="stringliteral">&#39;e-         &#39;</span> <span class="comment">!&lt; Gas phase electrons</span>
<a name="l00044"></a><a class="code" href="namespaceglobal__variables.html#ab891afd57405e4f8b69628d9b16705e1">00044</a> <span class="keywordtype">character(len=11)</span> :: YGRAIN = <span class="stringliteral">&#39;GRAIN0     &#39;</span> <span class="comment">!&lt; Grain</span>
<a name="l00045"></a><a class="code" href="namespaceglobal__variables.html#aeb9d5362587d4aa7bc7261745f0ca1a4">00045</a> <span class="keywordtype">character(len=11)</span> :: YCO    = <span class="stringliteral">&#39;CO         &#39;</span> <span class="comment">!&lt; Gas phase CO</span>
<a name="l00046"></a>00046 
<a name="l00047"></a><a class="code" href="namespaceglobal__variables.html#a67aa744317874118e66df5f4dd7b3906">00047</a> <span class="keywordtype">integer</span> :: INDCO <span class="comment">!&lt; Index corresponding to CO in nb_species length arrays</span>
<a name="l00048"></a><a class="code" href="namespaceglobal__variables.html#af26f63382d7d2835408a4bc4ea7bcd7c">00048</a> <span class="keywordtype">integer</span> :: INDH2 <span class="comment">!&lt; Index corresponding to H2 in nb_species length arrays</span>
<a name="l00049"></a><a class="code" href="namespaceglobal__variables.html#a3bb38d6ae6cb927a2596bae901371a51">00049</a> <span class="keywordtype">integer</span> :: INDHE <span class="comment">!&lt; Index corresponding to He in nb_species length arrays</span>
<a name="l00050"></a><a class="code" href="namespaceglobal__variables.html#a549ff226958070bf7c2b856f30a37c72">00050</a> <span class="keywordtype">integer</span> :: INDEL <span class="comment">!&lt; Index corresponding to e- in nb_species length arrays</span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="comment">! Arrays about prime elements</span>
<a name="l00054"></a><a class="code" href="namespaceglobal__variables.html#abaa9075c9e4e9207709dfeb916dbbafd">00054</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: INITIAL_ELEMENTAL_ABUNDANCE <span class="comment">!&lt; dim(NB_PRIME_ELEMENTS) Store abundances for all </span>
<a name="l00055"></a>00055 <span class="comment">!! elemental species before running the simulation.</span>
<a name="l00056"></a><a class="code" href="namespaceglobal__variables.html#a76bf6485d2438e8203b161d202009088">00056</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: elemental_mass <span class="comment">!&lt; dim(NB_PRIME_ELEMENTS) elemental mass.</span>
<a name="l00057"></a><a class="code" href="namespaceglobal__variables.html#afeff04f28cb9a38f88b9411215a11231">00057</a> <span class="keywordtype">character(len=11)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: element_name <span class="comment">!&lt; dim(NB_PRIME_ELEMENTS) elemental mass.</span>
<a name="l00058"></a><a class="code" href="namespaceglobal__variables.html#a3720fab2dbfb6ee864ac34d586f78352">00058</a> <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: PRIME_ELEMENT_IDX <span class="comment">! &lt; dim(NB_PRIME_ELEMENTS) Tell for each prime element its index in the global array of all elements.</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="comment">! Arrays about species</span>
<a name="l00061"></a><a class="code" href="namespaceglobal__variables.html#a04617384cd2be82e5e894bfd695d9a5d">00061</a> <span class="keywordtype">character(len=11)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: species_name <span class="comment">!&lt; dim(nb_species)</span>
<a name="l00062"></a><a class="code" href="namespaceglobal__variables.html#a6180c6ee007a61d6dfd0f5bd6c5c6029">00062</a> <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: species_composition <span class="comment">!&lt; dim(NB_PRIME_ELEMENTS,nb_species) number of atom of each element composition the given species.</span>
<a name="l00063"></a><a class="code" href="namespaceglobal__variables.html#ad3306b4302b6492f2d2e59117d500699">00063</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: abundances <span class="comment">!&lt; dim(nb_species) Species abundances</span>
<a name="l00064"></a><a class="code" href="namespaceglobal__variables.html#aa7a0a8422c69c8975f44d085750ad5df">00064</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: AWT <span class="comment">!&lt; dim(nb_species)</span>
<a name="l00065"></a><a class="code" href="namespaceglobal__variables.html#a6e81a15c16c301fce96b9ceeb0a83681">00065</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: TINDIF <span class="comment">!&lt; dim(nb_species)</span>
<a name="l00066"></a><a class="code" href="namespaceglobal__variables.html#a332de76270ae8c6d2b55d807e3048933">00066</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: TINACC <span class="comment">!&lt; dim(nb_species)</span>
<a name="l00067"></a><a class="code" href="namespaceglobal__variables.html#a2c22b1c30790c66048620e8d915a3f52">00067</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: TINEVA <span class="comment">!&lt; dim(nb_species)</span>
<a name="l00068"></a><a class="code" href="namespaceglobal__variables.html#a31a634db1c771067603d00c4a686a495">00068</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: ED <span class="comment">!&lt; dim(nb_species)</span>
<a name="l00069"></a><a class="code" href="namespaceglobal__variables.html#a4692dc61a7dfffbed4f913c68e560e44">00069</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: EB <span class="comment">!&lt; dim(nb_species)</span>
<a name="l00070"></a><a class="code" href="namespaceglobal__variables.html#a238864e6d347f2315a6a8c827e69cafc">00070</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: DEB <span class="comment">!&lt; dim(nb_species)</span>
<a name="l00071"></a><a class="code" href="namespaceglobal__variables.html#ae5d60e6d5bb8f006f24d8b37d4fe4914">00071</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: DHF <span class="comment">!&lt; dim(nb_species)</span>
<a name="l00072"></a><a class="code" href="namespaceglobal__variables.html#aedde27d31130429801962a2fbc55e790">00072</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: CHF <span class="comment">!&lt; dim(nb_species)</span>
<a name="l00073"></a><a class="code" href="namespaceglobal__variables.html#ac46ea159454e21892985c1e4ee3df55c">00073</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: CONDSP <span class="comment">!&lt; dim(nb_species)</span>
<a name="l00074"></a><a class="code" href="namespaceglobal__variables.html#a897ff33b235f3e0853e43e64d00d73de">00074</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: RQ1 <span class="comment">!&lt; dim(nb_species)</span>
<a name="l00075"></a><a class="code" href="namespaceglobal__variables.html#ad204d32b76057fbc1556d214a79db0c7">00075</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: RQ2 <span class="comment">!&lt; dim(nb_species)</span>
<a name="l00076"></a><a class="code" href="namespaceglobal__variables.html#a39123476f5f2eb6dff7737ffe7cb8784">00076</a> <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: SPECIES_CHARGE <span class="comment">!&lt; dim(nb_species) !&lt; electric charge [in e-] for each species, 0 if neutral, positive or negative if ions.</span>
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="comment">! Arrays about reactions</span>
<a name="l00079"></a><a class="code" href="namespaceglobal__variables.html#a90b37647e2ee578bfb44d897576125a3">00079</a> <span class="keywordtype">character(len=11)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: REACTION_SUBSTANCES_NAMES <span class="comment">!&lt; dim(7,nb_reactions)</span>
<a name="l00080"></a><a class="code" href="namespaceglobal__variables.html#ab899443e7a09652b2ce82d94964f9605">00080</a> <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: REACTION_SUBSTANCES_ID <span class="comment">!&lt; dim(7, nb_reactions) for all reactions, list for reactants (first 3) and products (last 4).</span>
<a name="l00081"></a><a class="code" href="namespaceglobal__variables.html#af1bcfffabd3524ab9e31c0f51af4fcd5">00081</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: XJ <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00082"></a><a class="code" href="namespaceglobal__variables.html#a6b58839271251f1570f7a836fbb5f569">00082</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: A <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00083"></a><a class="code" href="namespaceglobal__variables.html#ac84046c2906a233d9c0fb93f895cc90c">00083</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: B <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00084"></a><a class="code" href="namespaceglobal__variables.html#a615a678685619b06cfbeff1132b7cdc2">00084</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: C <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00085"></a><a class="code" href="namespaceglobal__variables.html#ab3b5d1d3bfa2b06191bfece7f4582d1f">00085</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: XK <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00086"></a><a class="code" href="namespaceglobal__variables.html#a30d6182488a0bfd3072bbcbb41e02d9e">00086</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: RDIF1 <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00087"></a><a class="code" href="namespaceglobal__variables.html#a6fc20d2d106a5ccfd92f3f780c2f20ba">00087</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: RDIF2 <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00088"></a><a class="code" href="namespaceglobal__variables.html#a384513fdc79b6b944ee3561f25c31240">00088</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: EX1 <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00089"></a><a class="code" href="namespaceglobal__variables.html#a0fd634bf6403a8e8a91cac89ae000fbb">00089</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: EX2 <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00090"></a><a class="code" href="namespaceglobal__variables.html#a3ef750853b67055d92ead68f2c88f802">00090</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: EA <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00091"></a><a class="code" href="namespaceglobal__variables.html#a2a1c0b6d5c9095aefb46572643e5643d">00091</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: Tmin <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00092"></a><a class="code" href="namespaceglobal__variables.html#aa97b0798ed6879f4304a569a894e6221">00092</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: Tmax <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00093"></a><a class="code" href="namespaceglobal__variables.html#a0c62af56d482e9d1e355df1681de241c">00093</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: ACT1 <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00094"></a><a class="code" href="namespaceglobal__variables.html#a8d2276107a9630baae2ae2e4b34eadba">00094</a> <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: REACTION_TYPE <span class="comment">!&lt; dim(nb_reactions) For each reaction, what is its type (cosmic ray evaporation, etc...)</span>
<a name="l00095"></a><a class="code" href="namespaceglobal__variables.html#a1b2cb7f4216d13dae5e02020329e3db0">00095</a> <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: jsp1 <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00096"></a><a class="code" href="namespaceglobal__variables.html#a32e7ac8cde72e2964bffd929f7dcf565">00096</a> <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: jsp2 <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00097"></a><a class="code" href="namespaceglobal__variables.html#ac23c31abc38b712418a4340af854eedf">00097</a> <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: FORMULA <span class="comment">!&lt; dim(nb_reactions)</span>
<a name="l00098"></a><a class="code" href="namespaceglobal__variables.html#ab57afaa2f7711c88f0187586a8f231f9">00098</a> <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: REACTION_ID <span class="comment">!&lt; dim(nb_reactions) index of the reactions (one of the columns of the concerned file, </span>
<a name="l00099"></a>00099 <span class="comment">!! declaring a given number for each reaction, like a hashtag.</span>
<a name="l00100"></a>00100 
<a name="l00101"></a><a class="code" href="namespaceglobal__variables.html#a5d6fa69c3d28ad6c2b7c4f81b8892056">00101</a> <span class="keywordtype">real(double_precision)</span> :: initial_dtg_mass_ratio
<a name="l00102"></a><a class="code" href="namespaceglobal__variables.html#a9cfac828196dd36b6608931be24d610f">00102</a> <span class="keywordtype">real(double_precision)</span> :: GTODN
<a name="l00103"></a><a class="code" href="namespaceglobal__variables.html#a032ebc8d525bc95b1df9f75738ed4568">00103</a> <span class="keywordtype">real(double_precision)</span> :: AV_NH_ratio
<a name="l00104"></a><a class="code" href="namespaceglobal__variables.html#ad293e774768851488b5ef7ced6737d6e">00104</a> <span class="keywordtype">real(double_precision)</span> :: grain_radius
<a name="l00105"></a><a class="code" href="namespaceglobal__variables.html#a39748bb1d51771921d9535a649cd94c1">00105</a> <span class="keywordtype">real(double_precision)</span> :: GRAIN_DENSITY
<a name="l00106"></a><a class="code" href="namespaceglobal__variables.html#afa6a1fd623df40f14f9e409dbdf8b97a">00106</a> <span class="keywordtype">real(double_precision)</span> :: sticking_coeff_neutral
<a name="l00107"></a><a class="code" href="namespaceglobal__variables.html#a7def8dd1c727f4b7bc6979144ed911bb">00107</a> <span class="keywordtype">real(double_precision)</span> :: sticking_coeff_positive
<a name="l00108"></a><a class="code" href="namespaceglobal__variables.html#aca4864a3e8d58051e44da8d925ee71fc">00108</a> <span class="keywordtype">real(double_precision)</span> :: sticking_coeff_negative
<a name="l00109"></a><a class="code" href="namespaceglobal__variables.html#ade20388d5927ffdd24aa71e292d72e05">00109</a> <span class="keywordtype">real(double_precision)</span> :: MINIMUM_INITIAL_ABUNDANCE
<a name="l00110"></a><a class="code" href="namespaceglobal__variables.html#ad8c6e0f43cbfebacfed34e1f1921ef92">00110</a> <span class="keywordtype">real(double_precision)</span> :: H_number_density <span class="comment">!&lt; Total H number density (both H and H2)</span>
<a name="l00111"></a><a class="code" href="namespaceglobal__variables.html#a408609ea169ac05b71940a129eae349f">00111</a> <span class="keywordtype">real(double_precision)</span> :: initial_gas_density
<a name="l00112"></a><a class="code" href="namespaceglobal__variables.html#ab9dd50afd8abd86bbd3380d959de6a92">00112</a> <span class="keywordtype">real(double_precision)</span> :: gas_temperature <span class="comment">!&lt; current gas temperature [K]</span>
<a name="l00113"></a><a class="code" href="namespaceglobal__variables.html#ac472b6ac150f184da9ec93d75ac42adf">00113</a> <span class="keywordtype">real(double_precision)</span> :: initial_gas_temperature <span class="comment">!&lt; initial gas temperature [K], simulation parameter</span>
<a name="l00114"></a><a class="code" href="namespaceglobal__variables.html#ab165b9b5b824a85985f8b99f82e1ae67">00114</a> <span class="keywordtype">real(double_precision)</span> :: dust_temperature <span class="comment">!&lt; current dust temperature [K]</span>
<a name="l00115"></a><a class="code" href="namespaceglobal__variables.html#ac58b1010408bf3f4a86bd39a53b710c7">00115</a> <span class="keywordtype">real(double_precision)</span> :: initial_dust_temperature <span class="comment">!&lt; initial dust temperature [K], simulation parameter</span>
<a name="l00116"></a><a class="code" href="namespaceglobal__variables.html#a70719d43ec2f69b5c28c61897ab75aab">00116</a> <span class="keywordtype">real(double_precision)</span> :: visual_extinction <span class="comment">!&lt; visual extinction of the molecular cloud (or other astronomical object). </span>
<a name="l00117"></a>00117 <span class="comment">!! It&#39;s the magnitude attenuation, difference from the absolute magnitude of the object and its apparent magnitude</span>
<a name="l00118"></a><a class="code" href="namespaceglobal__variables.html#a9ea77b72e491267d134633833dd9c04b">00118</a> <span class="keywordtype">real(double_precision)</span> :: INITIAL_VISUAL_EXTINCTION
<a name="l00119"></a><a class="code" href="namespaceglobal__variables.html#abcb701fe084819f14c57fb80f7c2b849">00119</a> <span class="keywordtype">real(double_precision)</span> :: CR_IONISATION_RATE
<a name="l00120"></a><a class="code" href="namespaceglobal__variables.html#a22c25f3a7738bb754b2da9a33197668b">00120</a> <span class="keywordtype">real(double_precision)</span> :: UV_FLUX
<a name="l00121"></a><a class="code" href="namespaceglobal__variables.html#abed081160b86611bd15a79c7b089e0e0">00121</a> <span class="keywordtype">real(double_precision)</span> :: LAYERS
<a name="l00122"></a><a class="code" href="namespaceglobal__variables.html#a0ec834d8661f622f7cded94b4e688305">00122</a> <span class="keywordtype">real(double_precision)</span> :: SITE_SPACING
<a name="l00123"></a><a class="code" href="namespaceglobal__variables.html#a933099f4d1ff4364609731cc121b2aff">00123</a> <span class="keywordtype">real(double_precision)</span> :: SITE_DENSITY
<a name="l00124"></a><a class="code" href="namespaceglobal__variables.html#ad8d5a490d2fca20f34af76035faa7fa3">00124</a> <span class="keywordtype">real(double_precision)</span> :: nb_sites_per_grain
<a name="l00125"></a><a class="code" href="namespaceglobal__variables.html#a43f199f97074dc5d35bc1da7154da4a5">00125</a> <span class="keywordtype">real(double_precision)</span> :: ACT
<a name="l00126"></a><a class="code" href="namespaceglobal__variables.html#aea0bc9655f317d234b736a84f543ed8e">00126</a> <span class="keywordtype">real(double_precision)</span> :: TSMAX
<a name="l00127"></a><a class="code" href="namespaceglobal__variables.html#af73315edf994ae08c8c9b0c7921e06a7">00127</a> <span class="keywordtype">real(double_precision)</span> :: CRT
<a name="l00128"></a><a class="code" href="namespaceglobal__variables.html#a403f3bbb5987b974e2929ce8aa4b930b">00128</a> <span class="keywordtype">real(double_precision)</span> :: CRFE
<a name="l00129"></a><a class="code" href="namespaceglobal__variables.html#aa0637cca025d18b6f92c6c2626610f4b">00129</a> <span class="keywordtype">real(double_precision)</span> :: EBFAC
<a name="l00130"></a><a class="code" href="namespaceglobal__variables.html#a380ca9245a00380e4b33dae98b1cd3d6">00130</a> <span class="keywordtype">real(double_precision)</span> :: START_TIME <span class="comment">!&lt; Start time of the simulation [s]</span>
<a name="l00131"></a><a class="code" href="namespaceglobal__variables.html#aa52731cb1a97233e90cf65f7ae79fa0d">00131</a> <span class="keywordtype">real(double_precision)</span> :: STOP_TIME <span class="comment">!&lt; Stop time of the simulation [s]</span>
<a name="l00132"></a><a class="code" href="namespaceglobal__variables.html#a6b6d04c38cdb015e56dc5231a8e3c882">00132</a> <span class="keywordtype">real(double_precision)</span> :: current_time <span class="comment">!&lt; Global current time of the simulation [s]</span>
<a name="l00133"></a><a class="code" href="namespaceglobal__variables.html#ad0f77444a6d11b73e500069d421b1198">00133</a> <span class="keywordtype">real(double_precision)</span> :: ARRK
<a name="l00134"></a>00134 
<a name="l00135"></a><a class="code" href="namespaceglobal__variables.html#a5287d7c37c7a666300985cd2241c7e4f">00135</a> <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: MAX_NUMBER_REACTION_TYPE=100 <span class="comment">!&lt; Max number of various reaction type</span>
<a name="l00136"></a>00136 <span class="comment">! The following arrays start at 0 because the index correspond to the reaction type as indexed elsewhere, and there is a type 0 for reactions.</span>
<a name="l00137"></a><a class="code" href="namespaceglobal__variables.html#a72678d4a3e42c7707c53312a0bfd820a">00137</a> <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(0:MAX_NUMBER_REACTION_TYPE-1)</span> :: type_id_start <span class="comment">!&lt; list of id start for each reaction type given their type number</span>
<a name="l00138"></a><a class="code" href="namespaceglobal__variables.html#a8e042ab32439646714871e722e3b8c18">00138</a> <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(0:MAX_NUMBER_REACTION_TYPE-1)</span> :: type_id_stop <span class="comment">!&lt; list of id stop for each reaction type given their type number</span>
<a name="l00139"></a>00139 
<a name="l00140"></a><a class="code" href="namespaceglobal__variables.html#aad1529a525462ea536c9fa3f8a6d7595">00140</a> <span class="keywordtype">integer</span> :: IS_GRAIN_REACTIONS
<a name="l00141"></a><a class="code" href="namespaceglobal__variables.html#a6133a2ce729a3d2e5cebd02c0073edfb">00141</a> <span class="keywordtype">integer</span> :: GRAIN_TUNNELING_DIFFUSION
<a name="l00142"></a><a class="code" href="namespaceglobal__variables.html#ade63b37eca05f951b05b1dc0248ffc3f">00142</a> <span class="keywordtype">integer</span> :: CONSERVATION_TYPE
<a name="l00143"></a><a class="code" href="namespaceglobal__variables.html#a271966988ac3f788845df21f7d18d6c6">00143</a> <span class="keywordtype">integer</span> :: IMODH
<a name="l00144"></a><a class="code" href="namespaceglobal__variables.html#af8a4262f63596ad8657d1cf0ac3b3840">00144</a> <span class="keywordtype">integer</span> :: IS_ABSORPTION
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 <span class="comment">! About the optimization so that, for each species, we only check the reactions we know the species is involved.</span>
<a name="l00147"></a><a class="code" href="namespaceglobal__variables.html#a57473363de41374f2a30bcb0bb498e94">00147</a> <span class="keywordtype">integer</span> :: max_reactions_same_species <span class="comment">!&lt; Maximum number of reactions in which any species will be involved. Used to set the array &#39;relevant_reactions&#39;</span>
<a name="l00148"></a><a class="code" href="namespaceglobal__variables.html#a76e501e660f37a222b9cedb83599d22c">00148</a> <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">allocatable</span> :: relevant_reactions <span class="comment">!&lt; dim(max_reactions_same_species, nb_species) For each species, store the list of reactions involving the species. </span>
<a name="l00149"></a>00149 <span class="comment">!! When 0 are encountered for a given species, this means that no more reactions involve it. dimensions : (max_reactions_same_species, nb_species)</span>
<a name="l00150"></a><a class="code" href="namespaceglobal__variables.html#a5272ac866f093cc83feb14708002dd40">00150</a> <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: nb_reactions_using_species <span class="comment">!&lt; dim(nb_species) For each species, the number of reactions in which it is used</span>
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 <span class="comment">! For LSODES</span>
<a name="l00153"></a><a class="code" href="namespaceglobal__variables.html#ae85f1490b4545b6142ecdfa4ae710309">00153</a> <span class="keywordtype">integer</span> :: lrw, liw
<a name="l00154"></a><a class="code" href="namespaceglobal__variables.html#ad2ab051c914a40f8c5f1afbcc7b0d1cd">00154</a> <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: IWORK <span class="comment">!&lt; dim(liw)</span>
<a name="l00155"></a><a class="code" href="namespaceglobal__variables.html#a9f741fdb815ceee60ca6562d733196b8">00155</a> <span class="keywordtype">real(double_precision)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: RWORK <span class="comment">!&lt; dim(lrw)</span>
<a name="l00156"></a><a class="code" href="namespaceglobal__variables.html#aa0be0f02b1f6186d5f588b6b461281ea">00156</a> <span class="keywordtype">integer</span> :: nb_nonzeros_values <span class="comment">!&lt; number of non-zeros values in the jacobian. This is usefull for ODEPACK, to increase speed</span>
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 <span class="comment">! Diffusion and 1D variables</span>
<a name="l00159"></a><a class="code" href="namespaceglobal__variables.html#a9ac1774271a2c98792808fb4ac91a316">00159</a> <span class="keywordtype">real(double_precision)</span> :: X_IONISATION_RATE
<a name="l00160"></a><a class="code" href="namespaceglobal__variables.html#ad83c677657aaaf49b0a64b3e693eceb1">00160</a> <span class="keywordtype">real(double_precision)</span> :: NCO <span class="comment">! column density [cm-2] (for the self shielding)</span>
<a name="l00161"></a><a class="code" href="namespaceglobal__variables.html#abbcb53eabba6615b09054867432db21e">00161</a> <span class="keywordtype">real(double_precision)</span> :: NH2 <span class="comment">! column density [cm-2] (for the self shielding)</span>
<a name="l00162"></a>00162 
<a name="l00163"></a><a class="code" href="namespaceglobal__variables.html#aa4c5d6aebbab967a09d481f86f109eb3">00163</a> <span class="keywordtype">integer</span> :: timestep
<a name="l00164"></a><a class="code" href="namespaceglobal__variables.html#aed1b3729555ef930a63d546483070ed3">00164</a> <span class="keywordtype">integer</span> :: OUTPUT_PER_DECADE
<a name="l00165"></a><a class="code" href="namespaceglobal__variables.html#a7077f24ce940dd688e02b0e229b6b2cf">00165</a> <span class="keywordtype">integer</span> :: wstep
<a name="l00166"></a><a class="code" href="namespaceglobal__variables.html#a2b22590c37328f882fdd6a948b45239a">00166</a> <span class="keywordtype">integer</span> :: wstepr
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 <span class="keyword">contains</span> 
<a name="l00169"></a>00169 
<a name="l00170"></a>00170 <span class="comment">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<a name="l00183"></a><a class="code" href="namespaceglobal__variables.html#ab2cadfd3c1baf79993639b9632cddb16">00183</a> <span class="keyword">subroutine </span><a class="code" href="namespaceglobal__variables.html#ab2cadfd3c1baf79993639b9632cddb16">get_array_sizes</a>()
<a name="l00184"></a>00184 
<a name="l00185"></a>00185 <span class="keyword">implicit none</span>
<a name="l00186"></a>00186 
<a name="l00187"></a>00187 <span class="comment">! We get the number of reactions and species</span>
<a name="l00188"></a>00188 call <a class="code" href="namespaceutilities.html#a0d7fc77fca8bc3c15c98da2b7db4cc93">get_linenumber</a>(filename=<span class="stringliteral">&#39;gas_species.in&#39;</span>, nb_lines=<a class="code" href="namespaceglobal__variables.html#a9eb4858dc86bcaf6f75a2b2a77786097">nb_species_for_gas</a>)
<a name="l00189"></a>00189 call <a class="code" href="namespaceutilities.html#a0d7fc77fca8bc3c15c98da2b7db4cc93">get_linenumber</a>(filename=<span class="stringliteral">&#39;gas_reactions.in&#39;</span>, nb_lines=<a class="code" href="namespaceglobal__variables.html#a1386249b61536332c06b75ca9fd9ed45">nb_gas_phase_reactions</a>)
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 call <a class="code" href="namespaceutilities.html#a0d7fc77fca8bc3c15c98da2b7db4cc93">get_linenumber</a>(filename=<span class="stringliteral">&#39;grain_species.in&#39;</span>, nb_lines=<a class="code" href="namespaceglobal__variables.html#a123983c27b5980f7064915557e53f63a">nb_species_for_grain</a>)
<a name="l00192"></a>00192 call <a class="code" href="namespaceutilities.html#a0d7fc77fca8bc3c15c98da2b7db4cc93">get_linenumber</a>(filename=<span class="stringliteral">&#39;grain_reactions.in&#39;</span>, nb_lines=<a class="code" href="namespaceglobal__variables.html#a7776be480fd35a80eb7077912c2ff212">nb_surface_reactions</a>)
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 
<a name="l00196"></a>00196 <a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a> = <a class="code" href="namespaceglobal__variables.html#a9eb4858dc86bcaf6f75a2b2a77786097">nb_species_for_gas</a> + <a class="code" href="namespaceglobal__variables.html#a123983c27b5980f7064915557e53f63a">nb_species_for_grain</a> <span class="comment">! The total number of species, sum of species in gas and grain</span>
<a name="l00197"></a>00197 <a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a> = <a class="code" href="namespaceglobal__variables.html#a1386249b61536332c06b75ca9fd9ed45">nb_gas_phase_reactions</a> + <a class="code" href="namespaceglobal__variables.html#a7776be480fd35a80eb7077912c2ff212">nb_surface_reactions</a> <span class="comment">! The total number of reactions, sum of species in gas and grain</span>
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 <span class="keyword">end subroutine get_array_sizes</span>
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 <span class="comment">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<a name="l00211"></a><a class="code" href="namespaceglobal__variables.html#a84bbdabf06c92318f689ac25ae01bb99">00211</a> <span class="keyword">subroutine </span><a class="code" href="namespaceglobal__variables.html#a84bbdabf06c92318f689ac25ae01bb99">initialize_global_arrays</a>()
<a name="l00212"></a>00212 
<a name="l00213"></a>00213 <span class="keyword">implicit none</span>
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 <span class="keyword">allocate</span>(<a class="code" href="namespaceglobal__variables.html#a04617384cd2be82e5e894bfd695d9a5d">species_name</a>(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00216"></a>00216 <span class="keyword">allocate</span>(<a class="code" href="namespaceglobal__variables.html#ad3306b4302b6492f2d2e59117d500699">abundances</a>(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00217"></a>00217 <span class="keyword">allocate</span>(awt(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00218"></a>00218 <span class="keyword">allocate</span>(tindif(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00219"></a>00219 <span class="keyword">allocate</span>(tinacc(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00220"></a>00220 <span class="keyword">allocate</span>(tineva(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00221"></a>00221 <span class="keyword">allocate</span>(ed(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00222"></a>00222 <span class="keyword">allocate</span>(eb(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00223"></a>00223 <span class="keyword">allocate</span>(deb(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00224"></a>00224 <span class="keyword">allocate</span>(dhf(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00225"></a>00225 <span class="keyword">allocate</span>(chf(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00226"></a>00226 <span class="keyword">allocate</span>(condsp(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00227"></a>00227 <span class="keyword">allocate</span>(rq1(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00228"></a>00228 <span class="keyword">allocate</span>(rq2(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00229"></a>00229 <span class="keyword">allocate</span>(<a class="code" href="namespaceglobal__variables.html#a39123476f5f2eb6dff7737ffe7cb8784">SPECIES_CHARGE</a>(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00230"></a>00230 <span class="keyword">allocate</span>(<a class="code" href="namespaceglobal__variables.html#a5272ac866f093cc83feb14708002dd40">nb_reactions_using_species</a>(<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00231"></a>00231 
<a name="l00232"></a>00232 <span class="keyword">allocate</span>(xj(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00233"></a>00233 <span class="keyword">allocate</span>(a(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00234"></a>00234 <span class="keyword">allocate</span>(b(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00235"></a>00235 <span class="keyword">allocate</span>(c(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00236"></a>00236 <span class="keyword">allocate</span>(xk(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00237"></a>00237 <span class="keyword">allocate</span>(rdif1(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00238"></a>00238 <span class="keyword">allocate</span>(rdif2(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00239"></a>00239 <span class="keyword">allocate</span>(ex1(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00240"></a>00240 <span class="keyword">allocate</span>(ex2(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00241"></a>00241 <span class="keyword">allocate</span>(ea(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00242"></a>00242 <span class="keyword">allocate</span>(tmin(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00243"></a>00243 <span class="keyword">allocate</span>(tmax(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00244"></a>00244 <span class="keyword">allocate</span>(act1(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00245"></a>00245 <span class="keyword">allocate</span>(<a class="code" href="namespaceglobal__variables.html#a8d2276107a9630baae2ae2e4b34eadba">REACTION_TYPE</a>(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00246"></a>00246 <span class="keyword">allocate</span>(<a class="code" href="namespaceglobal__variables.html#a1b2cb7f4216d13dae5e02020329e3db0">jsp1</a>(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00247"></a>00247 <span class="keyword">allocate</span>(<a class="code" href="namespaceglobal__variables.html#a32e7ac8cde72e2964bffd929f7dcf565">jsp2</a>(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00248"></a>00248 <span class="keyword">allocate</span>(formula(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00249"></a>00249 <span class="keyword">allocate</span>(<a class="code" href="namespaceglobal__variables.html#ab57afaa2f7711c88f0187586a8f231f9">REACTION_ID</a>(<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00250"></a>00250 <span class="keyword">allocate</span>(<a class="code" href="namespaceglobal__variables.html#ab899443e7a09652b2ce82d94964f9605">REACTION_SUBSTANCES_ID</a>(7,<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00251"></a>00251 <span class="keyword">allocate</span>(<a class="code" href="namespaceglobal__variables.html#a90b37647e2ee578bfb44d897576125a3">REACTION_SUBSTANCES_NAMES</a>(7,<a class="code" href="namespaceglobal__variables.html#a817eda6b6bf84e137c7e0f9445e36916">nb_reactions</a>))
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 <span class="keyword">allocate</span>(<a class="code" href="namespaceglobal__variables.html#abaa9075c9e4e9207709dfeb916dbbafd">INITIAL_ELEMENTAL_ABUNDANCE</a>(<a class="code" href="namespaceglobal__variables.html#a2aa4be5d11df79c25e4b2474494dc0b7">NB_PRIME_ELEMENTS</a>))
<a name="l00254"></a>00254 <span class="keyword">allocate</span>(<a class="code" href="namespaceglobal__variables.html#a3720fab2dbfb6ee864ac34d586f78352">PRIME_ELEMENT_IDX</a>(<a class="code" href="namespaceglobal__variables.html#a2aa4be5d11df79c25e4b2474494dc0b7">NB_PRIME_ELEMENTS</a>))
<a name="l00255"></a>00255 <span class="keyword">allocate</span>(<a class="code" href="namespaceglobal__variables.html#a6180c6ee007a61d6dfd0f5bd6c5c6029">species_composition</a>(<a class="code" href="namespaceglobal__variables.html#a2aa4be5d11df79c25e4b2474494dc0b7">NB_PRIME_ELEMENTS</a>,<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>))
<a name="l00256"></a>00256 
<a name="l00257"></a>00257 
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 <span class="keyword">end subroutine initialize_global_arrays</span>
<a name="l00260"></a>00260 
<a name="l00261"></a>00261 <span class="comment">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<a name="l00274"></a><a class="code" href="namespaceglobal__variables.html#acf3dcaac7261a4e59977b15ecb0543e3">00274</a> <span class="keyword">subroutine </span><a class="code" href="namespaceglobal__variables.html#acf3dcaac7261a4e59977b15ecb0543e3">get_gas_surface_species</a>()
<a name="l00275"></a>00275 
<a name="l00276"></a>00276 <span class="keyword">implicit none</span>
<a name="l00277"></a>00277 
<a name="l00278"></a>00278 <span class="comment">! Locals</span>
<a name="l00279"></a>00279 <span class="keywordtype">integer</span> :: i
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 <span class="comment">! We retrieve the total number of gas and surface species (not the ones that are involved in reactions, but the actual position of the species)</span>
<a name="l00282"></a>00282 <a class="code" href="namespaceglobal__variables.html#a92f61eb7a88fe738db011101272fe3c2">nb_gaseous_species</a> = 0
<a name="l00283"></a>00283 <a class="code" href="namespaceglobal__variables.html#a30928fefa37dcaeca6630b0fc4ec8a9a">nb_surface_species</a> = 0
<a name="l00284"></a>00284 <span class="keyword">do</span> i=1,<a class="code" href="namespaceglobal__variables.html#ad04596284d512f27430cf16e116b11b8">nb_species</a>
<a name="l00285"></a>00285   <span class="keyword">if</span> (<a class="code" href="namespaceglobal__variables.html#a04617384cd2be82e5e894bfd695d9a5d">species_name</a>(i)(1:1).eq.<span class="stringliteral">&#39;J&#39;</span>) <span class="keyword">then</span>
<a name="l00286"></a>00286     <a class="code" href="namespaceglobal__variables.html#a30928fefa37dcaeca6630b0fc4ec8a9a">nb_surface_species</a> = <a class="code" href="namespaceglobal__variables.html#a30928fefa37dcaeca6630b0fc4ec8a9a">nb_surface_species</a> + 1
<a name="l00287"></a>00287   <span class="keyword">else</span>
<a name="l00288"></a>00288     <a class="code" href="namespaceglobal__variables.html#a92f61eb7a88fe738db011101272fe3c2">nb_gaseous_species</a> = <a class="code" href="namespaceglobal__variables.html#a92f61eb7a88fe738db011101272fe3c2">nb_gaseous_species</a> + 1
<a name="l00289"></a>00289   <span class="keyword">endif</span>
<a name="l00290"></a>00290 <span class="keyword">end do</span>
<a name="l00291"></a>00291 
<a name="l00292"></a>00292 <span class="keyword">end subroutine get_gas_surface_species</span>
<a name="l00293"></a>00293 
<a name="l00294"></a>00294 <span class="keyword">end module global_variables</span>
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Thu Apr 24 2014 for Nautilus by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
